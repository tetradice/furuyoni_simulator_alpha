{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/main.ts","webpack:///./src/sakuraba.ts"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;AClFA,0EAAuC;AA2BvC,IAAM,SAAS,GAAkC;IAC3C,iBAAiB,EAAE,EAAC,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC,QAAQ,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,EAAE,EAAC;IACxH,iBAAiB,EAAE,EAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC,QAAQ,CAAC,EAAE,KAAK,EAAE,GAAG,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,wCAAwC,EAAC;IAC/J,iBAAiB,EAAE,EAAC,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC,QAAQ,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,qDAAqD,EAAC;IAC/K,iBAAiB,EAAE,EAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,QAAQ,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC,QAAQ,EAAE,WAAW,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,EAAE,EAAC;IACvI,iBAAiB,EAAE,EAAC,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,uBAAuB,EAAC;IACrH,iBAAiB,EAAE,EAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,QAAQ,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC,SAAS,CAAC,EAAE,QAAQ,EAAE,GAAG,EAAE,IAAI,EAAE,6BAA6B,EAAC;IACxI,iBAAiB,EAAE,EAAC,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,UAAU,EAAE,QAAQ,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC,SAAS,EAAE,WAAW,CAAC,EAAE,QAAQ,EAAE,GAAG,EAAE,IAAI,EAAE,4DAA4D,EAAC;IAC3L,iBAAiB,EAAE,EAAC,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,SAAS,EAAE,QAAQ,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,CAAC,QAAQ,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,EAAE,EAAC;IAC3I,iBAAiB,EAAE,EAAC,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,SAAS,EAAE,QAAQ,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,CAAC,QAAQ,EAAE,UAAU,CAAC,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,yBAAyB,EAAC;IAC/K,iBAAiB,EAAE,EAAC,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,SAAS,EAAE,QAAQ,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,qCAAqC,EAAC;IACjJ,iBAAiB,EAAE,EAAC,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,cAAc,EAAE,QAAQ,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,CAAC,QAAQ,EAAE,WAAW,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,sCAAsC,EAAC;CAC1M,CAAC;AAGF,MAAM;AACN;IAMI,cAAY,EAAU;QAClB,IAAI,CAAC,EAAE,GAAG,EAAE,CAAC;IACjB,CAAC;IAED,sBAAI,sBAAI;aAAR;YACI,OAAO,SAAS,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QAC9B,CAAC;;;OAAA;IACL,WAAC;AAAD,CAAC;AAED;IAAA;IAUA,CAAC;IATG,wBAAwB;IACjB,aAAI,GAAX,UAAY,QAAgB,EAAE,UAAkB,EAAE,OAAmB,EAAE,OAAmB;QAAxC,qCAAmB;QAAE,qCAAmB;QACtF,IAAI,MAAM,GAAG,CAAC,CAAC,QAAQ,CAAC,CAAC;QACzB,IAAI,SAAS,GAAG,MAAM,CAAC,UAAU,EAAE,CAAC;QAEpC,MAAM,CAAC,IAAI,CAAC,UAAS,CAAC,EAAE,IAAI;YACxB,CAAC,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,MAAM,EAAK,OAAO,GAAG,CAAC,SAAS,GAAG,OAAO,CAAC,GAAG,CAAC,OAAI,CAAC,CAAC,GAAG,CAAC,KAAK,EAAK,OAAO,OAAI,CAAC,CAAC;QAC/F,CAAC,CAAC,CAAC;IACP,CAAC;IACL,eAAC;AAAD,CAAC;AAED;IAAA;QAII,cAAS,GAAY,IAAI,CAAC;QAC1B,YAAO,GAAW,CAAC,CAAC;QAOpB,SAAI,GAAW,CAAC,CAAC;QACjB,QAAG,GAAW,CAAC,CAAC;QAEhB,UAAK,GAAY,KAAK,CAAC;IA0B3B,CAAC;IApBG;;OAEG;IACH,qCAAiB,GAAjB;QACI,OAAO,IAAI,CAAC,MAAM,KAAK,IAAI,CAAC,SAAS;eAClC,IAAI,CAAC,aAAa,KAAK,IAAI,CAAC,gBAAgB;eAC5C,IAAI,CAAC,SAAS,KAAK,IAAI,CAAC,YAAY;eACpC,IAAI,CAAC,OAAO,KAAK,IAAI,CAAC,UAAU;IACvC,CAAC;IAED,kCAAc,GAAd;QACI,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC;QAC7B,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,aAAa,CAAC;QAC3C,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC;QACnC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC;IACnC,CAAC;IAED,sBAAI,mCAAY;aAAhB;YACI,OAAO,CAAC,CAAC;QACb,CAAC;;;OAAA;IACL,gBAAC;AAAD,CAAC;AAED;IAA4B,iCAAS;IAArC;QAAA,qEAgDC;QA9CG,YAAM,GAAY,KAAK,CAAC;;IA8C5B,CAAC;IA3CG,8BAAM,GAAN;QACI,OAAM,CAAC,qDAA8C,IAAI,CAAC,aAAa,0BAAmB,IAAI,CAAC,IAAI,CAAC,EAAE,uBAAgB,IAAI,CAAC,kBAAkB,EAAE,cAAU,CAAC,CAAC;IAC/J,CAAC;IAED,yCAAiB,GAAjB;QACI,OAAO,iBAAM,iBAAiB,WAAE,IAAI,IAAI,CAAC,MAAM,KAAK,IAAI,CAAC,SAAS,CAAC;IACvE,CAAC;IAED,sCAAc,GAAd;QACI,iBAAM,cAAc,WAAE,CAAC;QACvB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC;IACjC,CAAC;IAED,0CAAkB,GAAlB;QACI,IAAI,aAAa,GAAG,eAAa,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,2BAAsB,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,2BAAwB;QACrH,IAAI,IAAI,GAAG,uDAAqD,aAAe;QAE/E,IAAI,IAAI,gCAAgC;QAExC,IAAI,YAAY,GAAG,EAAE,CAAC;QACtB,IAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC;YAAE,YAAY,CAAC,IAAI,CAAC,wDAAwD,CAAC,CAAC;QAC5H,IAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC;YAAE,YAAY,CAAC,IAAI,CAAC,yDAAyD,CAAC,CAAC;QAC7H,IAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC;YAAE,YAAY,CAAC,IAAI,CAAC,0DAA0D,CAAC,CAAC;QAC/H,IAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC;YAAE,YAAY,CAAC,IAAI,CAAC,2DAA2D,CAAC,CAAC;QACjI,IAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC;YAAE,YAAY,CAAC,IAAI,CAAC,yDAAyD,CAAC,CAAC;QAChI,IAAI,IAAI,KAAG,YAAY,CAAC,IAAI,CAAC,GAAG,CAAG,CAAC;QACpC,IAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,KAAK,SAAS,EAAC;YAClC,IAAI,IAAI,qCAAmC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,YAAS;SAC3E;QACD,IAAI,IAAI,MAAM,CAAC;QACf,IAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,KAAK,SAAS,EAAC;YACrC,IAAI,IAAI,8CAA4C,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,WAAQ,CAAC;SACnF;QACD,IAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,EAAC;YAC5C,IAAI,IAAI,aAAM,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,SAAM,CAAC;SAC/C;QACD,IAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,KAAK,SAAS,EAAC;YACnC,IAAI,IAAO,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,SAAM,CAAC;SAC1C;QACD,IAAI,IAAI,KAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,MAAM,CAAG,CAAC;QACvD,IAAI,IAAI,QAAQ,CAAC;QACjB,OAAO,IAAI,CAAC;IAChB,CAAC;IACL,oBAAC;AAAD,CAAC,CAhD2B,SAAS,GAgDpC;AAED;IAAmC,wCAAS;IAA5C;QAAA,qEASC;QARG,YAAM,GAAW,IAAI,CAAC;;IAQ1B,CAAC;IAPG,qCAAM,GAAN;QACI,OAAM,CAAC,yDAAkD,IAAI,CAAC,aAAa,cAAU,CAAC,CAAC;IAC3F,CAAC;IAED,sBAAI,8CAAY;aAAhB;YACI,OAAO,GAAG,CAAC;QACf,CAAC;;;OAAA;IACL,2BAAC;AAAD,CAAC,CATkC,SAAS,GAS3C;AAED;IAA6B,kCAAS;IAAtC;;IAsBA,CAAC;IArBG,+BAAM,GAAN;QACI,OAAM,CAAC,wCAAmC,IAAI,CAAC,aAAa,0IAIrD,CAAC,CAAC;IACb,CAAC;IAED,UAAU;IACV,iCAAQ,GAAR,UAAS,KAAa;QAClB,IAAG,KAAK,KAAK,CAAC,EAAC;YACX,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC;SACpB;QACD,IAAG,KAAK,KAAK,CAAC,EAAC;YACX,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC;SACpB;QACD,IAAG,KAAK,KAAK,CAAC,EAAC;YACX,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC;SACrB;IAEL,CAAC;IACL,qBAAC;AAAD,CAAC,CAtB4B,SAAS,GAsBrC;AAED,OAAO;AACP,IAAM,KAAK,GAAG;IACV,OAAO,EAAE,CAAC,IAAI,IAAI,CAAC,iBAAiB,CAAC,EAAE,IAAI,IAAI,CAAC,iBAAiB,CAAC,EAAE,IAAI,IAAI,CAAC,iBAAiB,CAAC,EAAE,IAAI,IAAI,CAAC,iBAAiB,CAAC,CAAW;IACvI,KAAK,EAAE,CAAC,IAAI,IAAI,CAAC,iBAAiB,CAAC,EAAE,IAAI,IAAI,CAAC,iBAAiB,CAAC,EAAE,IAAI,IAAI,CAAC,iBAAiB,CAAC,CAAW;IACxG,QAAQ,EAAE,CAAC,IAAI,IAAI,CAAC,iBAAiB,CAAC,EAAE,IAAI,IAAI,CAAC,iBAAiB,CAAC,EAAE,IAAI,IAAI,CAAC,iBAAiB,CAAC,CAAW;IAC3G,IAAI,EAAE,EAAE;IACR,UAAU,EAAE,EAAE;IACd,KAAK,EAAE,CAAC;IAER,YAAY,EAAE,EAA6B;IAE3C,IAAI,EAAE,CAAC;IACP,IAAI,EAAE,EAAE;IACR,KAAK,EAAE,CAAC;IACR,QAAQ,EAAE,EAAE;IACZ,IAAI,EAAE,CAAC;CACV;AAED,YAAY;AACZ,IAAM,UAAU,GAAgB,EAAE,CAAC;AAEnC,QAAQ;AACR,IAAI,YAAY,GAAc,IAAI,CAAC;AACnC,IAAI,2BAA2B,GAAY,KAAK,CAAC;AAEjD,KAAK;AACL,iBAAiB,KAAK;IAClB,IAAI,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC;IAE3B,OAAO,CAAC,EAAE;QACN,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,EAAE,CAAC,CAAC;QACpC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;QACb,KAAK,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;QACpB,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;KAChB;IAED,OAAO,KAAK,CAAC;AACjB,CAAC;AAED,6BAA6B,IAAU,EAAE,MAAkB,EAAE,aAAqB,EAAE,MAAuB;IAAvB,uCAAuB;IACvG,IAAI,OAAO,GAAG,IAAI,aAAa,CAAC;IAChC,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC;IACpB,OAAO,CAAC,aAAa,GAAG,WAAW,GAAG,IAAI,CAAC,EAAE,CAAC;IAC9C,OAAO,CAAC,MAAM,GAAG,MAAM,CAAC;IACxB,OAAO,CAAC,aAAa,GAAG,aAAa,CAAC;IACtC,OAAO,CAAC,MAAM,GAAG,MAAM,CAAC;IACxB,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IAEzB,OAAO,OAAO,CAAC;AACnB,CAAC;AAED;IACI,IAAI,IAAI,GAAG,IAAI,cAAc,CAAC;IAC9B,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC;IACtB,IAAI,CAAC,aAAa,GAAG,gBAAgB,CAAC;IACtC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AAC1B,CAAC;AAED,IAAI,qBAAqB,GAAG,CAAC,CAAC;AAC9B,oCAAoC,MAAuB,EAAE,KAAa;IACtE,KAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,EAAE,CAAC,EAAE,EAAC;QAC1B,IAAI,OAAO,GAAG,IAAI,oBAAoB,CAAC;QACvC,OAAO,CAAC,MAAM,GAAG,MAAM,CAAC;QACxB,OAAO,CAAC,aAAa,GAAG,CAAC,CAAC;QAC1B,OAAO,CAAC,aAAa,GAAG,kBAAgB,qBAAuB,CAAC;QAChE,qBAAqB,EAAE,CAAC;QACxB,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;KAC5B;AACL,CAAC;AAED,kBAAkB;AAClB;IACI,SAAS;IACT,IAAI,aAAa,GAAG,CAAC,CAAC,0BAA0B,CAAC,CAAC,QAAQ,EAAE,CAAC;IAC7D,UAAU,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,CAAC,MAAM,KAAK,SAAS,EAAtB,CAAsB,CAAC,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,CAAC;QAC3D,IAAI,CAAC,IAAI,GAAG,aAAa,CAAC,IAAI,GAAG,CAAC,GAAG,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC;QAC5D,IAAI,CAAC,GAAG,GAAG,aAAa,CAAC,GAAG,GAAG,CAAC,GAAG,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC;IAC9D,CAAC,CAAC,CAAC;IAEH,SAAS;IACT,IAAI,UAAU,GAAG,CAAC,CAAC,uBAAuB,CAAC,CAAC,QAAQ,EAAE,CAAC;IACvD,UAAU,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,CAAC,MAAM,KAAK,MAAM,EAAnB,CAAmB,CAAC,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,CAAC;QACxD,IAAI,CAAC,IAAI,GAAG,UAAU,CAAC,IAAI,GAAG,CAAC,GAAG,IAAI,CAAC,aAAa,GAAG,GAAG,CAAC;QAC3D,IAAI,CAAC,GAAG,GAAG,UAAU,CAAC,GAAG,GAAG,CAAC,CAAC;IAClC,CAAC,CAAC,CAAC;IAEH,UAAU;IACV,IAAI,aAAa,GAAG,CAAC,CAAC,0BAA0B,CAAC,CAAC,QAAQ,EAAE,CAAC;IAC7D,UAAU,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,CAAC,MAAM,KAAK,SAAS,EAAtB,CAAsB,CAAC,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,CAAC;QAC3D,IAAI,CAAC,IAAI,GAAG,aAAa,CAAC,IAAI,GAAG,CAAC,GAAG,IAAI,CAAC,aAAa,GAAG,GAAG,CAAC;QAC9D,IAAI,CAAC,GAAG,GAAG,aAAa,CAAC,GAAG,GAAG,CAAC,CAAC;IACrC,CAAC,CAAC,CAAC;IAEH,WAAW;IACX,IAAI,UAAU,GAAG,CAAC,CAAC,uBAAuB,CAAC,CAAC,QAAQ,EAAE,CAAC;IACvD,UAAU,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,CAAC,MAAM,KAAK,MAAM,EAAnB,CAAmB,CAAC,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,CAAC;QACxD,IAAI,CAAC,IAAI,GAAG,UAAU,CAAC,IAAI,GAAG,CAAC,GAAG,IAAI,CAAC,aAAa,GAAG,GAAG,CAAC;QAC3D,IAAI,CAAC,GAAG,GAAG,UAAU,CAAC,GAAG,GAAG,CAAC,CAAC;IAClC,CAAC,CAAC,CAAC;IAEH,UAAU;IACV,IAAI,gBAAgB,GAAG,CAAC,CAAC,8BAA8B,CAAC,CAAC,QAAQ,EAAE,CAAC;IACpE,UAAU,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,CAAC,MAAM,KAAK,aAAa,EAA1B,CAA0B,CAAC,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,CAAC;QAC/D,IAAI,CAAC,IAAI,GAAG,EAAE,GAAG,gBAAgB,CAAC,IAAI,GAAG,CAAC,GAAG,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC;QACpE,IAAI,CAAC,GAAG,GAAG,CAAC,EAAE,GAAG,gBAAgB,CAAC,GAAG,GAAG,CAAC,GAAG,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC;IACvE,CAAC,CAAC,CAAC;IAEH,UAAU;IACV,IAAI,WAAW,GAAG,CAAC,CAAC,aAAa,CAAC,CAAC,QAAQ,EAAE,CAAC;IAC9C,UAAU,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,YAAY,cAAc,EAA3B,CAA2B,CAAC,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,CAAC;QAChE,IAAG,IAAI,CAAC,OAAO,KAAK,CAAC,EAAC;YAClB,IAAI,CAAC,IAAI,GAAG,WAAW,CAAC,IAAI,CAAC;YAC7B,IAAI,CAAC,GAAG,GAAG,WAAW,CAAC,GAAG,GAAG,EAAE,CAAC;SACnC;aAAM;YACH,IAAI,CAAC,IAAI,GAAG,WAAW,CAAC,IAAI,CAAC;YAC7B,IAAI,CAAC,GAAG,GAAG,WAAW,CAAC,GAAG,GAAG,EAAE,CAAC;SACnC;IACL,CAAC,CAAC,CAAC;IAEH,WAAW;IACX,IAAI,cAAc,GAAG,CAAC,CAAC,oCAAoC,CAAC,CAAC,QAAQ,EAAE,CAAC;IACxE,UAAU,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,CAAC,MAAM,KAAK,UAAU,EAAvB,CAAuB,CAAC,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,CAAC;QAC5D,IAAI,CAAC,IAAI,GAAG,cAAc,CAAC,IAAI,GAAG,EAAE,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QACtD,IAAI,CAAC,GAAG,GAAG,cAAc,CAAC,GAAG,GAAG,CAAC,CAAC;IACtC,CAAC,CAAC,CAAC;IAEH,IAAI,UAAU,GAAG,CAAC,CAAC,gCAAgC,CAAC,CAAC,QAAQ,EAAE,CAAC;IAChE,UAAU,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,CAAC,MAAM,KAAK,MAAM,EAAnB,CAAmB,CAAC,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,CAAC;QACxD,IAAI,CAAC,IAAI,GAAG,UAAU,CAAC,IAAI,GAAG,EAAE,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QAClD,IAAI,CAAC,GAAG,GAAG,UAAU,CAAC,GAAG,GAAG,CAAC,CAAC;IAClC,CAAC,CAAC,CAAC;IAEH,IAAI,UAAU,GAAG,CAAC,CAAC,gCAAgC,CAAC,CAAC,QAAQ,EAAE,CAAC;IAChE,UAAU,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,CAAC,MAAM,KAAK,MAAM,EAAnB,CAAmB,CAAC,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,CAAC;QACxD,IAAI,CAAC,IAAI,GAAG,UAAU,CAAC,IAAI,GAAG,EAAE,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QAClD,IAAI,CAAC,GAAG,GAAG,UAAU,CAAC,GAAG,GAAG,CAAC,CAAC;IAClC,CAAC,CAAC,CAAC;IAEH,IAAI,UAAU,GAAG,CAAC,CAAC,gCAAgC,CAAC,CAAC,QAAQ,EAAE,CAAC;IAChE,UAAU,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,CAAC,MAAM,KAAK,MAAM,EAAnB,CAAmB,CAAC,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,CAAC;QACxD,IAAI,CAAC,IAAI,GAAG,UAAU,CAAC,IAAI,GAAG,EAAE,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QAClD,IAAI,CAAC,GAAG,GAAG,UAAU,CAAC,GAAG,GAAG,CAAC,CAAC;IAClC,CAAC,CAAC,CAAC;IAEH,IAAI,WAAW,GAAG,CAAC,CAAC,iCAAiC,CAAC,CAAC,QAAQ,EAAE,CAAC;IAClE,UAAU,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,CAAC,MAAM,KAAK,OAAO,EAApB,CAAoB,CAAC,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,CAAC;QACzD,IAAI,CAAC,IAAI,GAAG,WAAW,CAAC,IAAI,GAAG,EAAE,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QACnD,IAAI,CAAC,GAAG,GAAG,WAAW,CAAC,GAAG,GAAG,CAAC,CAAC;IACnC,CAAC,CAAC,CAAC;IAGH,UAAU,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,CAAC,MAAM,KAAK,SAAS,EAAtB,CAAsB,CAAC,CAAC,OAAO,CAAC,UAAC,IAA0B,EAAE,CAAC;QACjF,IAAI,MAAM,GAAG,CAAC,CAAC,mBAAiB,IAAI,CAAC,MAAM,MAAG,CAAC,CAAC,QAAQ,EAAE,CAAC;QAE3D,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI,GAAG,CAAC,GAAG,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;QACtD,IAAI,CAAC,GAAG,GAAG,MAAM,CAAC,GAAG,GAAG,GAAG,GAAG,CAAC,GAAG,EAAE,CAAC;IACzC,CAAC,CAAC,CAAC;IAEH,oBAAoB;IACpB,IAAI,WAAW,GAAG,CAAC,CAAC,QAAQ,CAAC,CAAC,MAAM,EAAE,CAAC;IACvC,UAAU,CAAC,OAAO,CAAC,UAAC,SAAS,EAAE,KAAK;QAChC,IAAI,KAAK,GAAW,IAAI,CAAC;QACzB,IAAG,CAAC,SAAS,CAAC,KAAK,EAAC;YAChB,CAAC,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC,CAAC;YACvC,KAAK,GAAG,CAAC,CAAC,MAAI,SAAS,CAAC,aAAe,CAAC,CAAC;SAC5C;QAED,IAAG,CAAC,SAAS,CAAC,KAAK,IAAI,SAAS,CAAC,iBAAiB,EAAE,EAAC;YACjD,IAAG,KAAK,KAAK,IAAI,EAAC;gBACd,KAAK,GAAG,CAAC,CAAC,MAAI,SAAS,CAAC,aAAe,CAAC,CAAC;aAC5C;YAED,yBAAyB,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;YAE5C,aAAa;YACb,SAAS,CAAC,cAAc,EAAE,CAAC;SAC9B;QAED,aAAa;QACb,IAAG,CAAC,SAAS,CAAC,KAAK,EAAC;YAChB,SAAS,CAAC,KAAK,GAAG,IAAI,CAAC;SAC1B;IACL,CAAC,CAAC,CAAC;IAEH,cAAc;IACd,CAAC,CAAC,gBAAgB,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,GAAG,CAAC,EAAC,KAAK,EAAE,QAAQ,CAAC,CAAC,CAAC,0BAA0B,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC,CAAC,0BAA0B,CAAC,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,GAAG,CAAC,EAAC,CAAC,CAAC;AAC7L,CAAC;AAED,mCAAmC,SAAoB,EAAE,KAAa;IAClE,YAAY;IACZ,IAAG,SAAS,CAAC,SAAS,EAAC;QACnB,KAAK,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC;KAC/B;SAAM;QACH,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC;KACjC;IAED,KAAK;IACL,KAAK,CAAC,WAAW,CAAC,CAAC,SAAS,EAAE,iBAAiB,CAAC,CAAC,CAAC;IAClD,IAAG,SAAS,CAAC,OAAO,KAAK,CAAC,EAAC;QACvB,KAAK,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;KAC7B;SAAM,IAAG,SAAS,CAAC,OAAO,KAAK,CAAC,CAAC,EAAC;QAC/B,KAAK,CAAC,QAAQ,CAAC,iBAAiB,CAAC,CAAC;KACrC;IAED,UAAU;IACV,IAAG,SAAS,YAAY,aAAa,EAAC;QAClC,QAAQ;QACR,KAAK,CAAC,WAAW,CAAC,CAAC,aAAa,EAAE,aAAa,EAAE,cAAc,EAAE,cAAc,CAAC,CAAC,CAAC;QAClF,IAAG,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,KAAK,QAAQ,EAAC;YACzC,IAAG,SAAS,CAAC,MAAM,EAAC;gBAChB,KAAK,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;aACjC;iBAAM;gBACH,KAAK,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;aACjC;SACJ;QACD,IAAG,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,KAAK,SAAS,EAAC;YAC1C,IAAG,SAAS,CAAC,MAAM,EAAC;gBAChB,KAAK,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC;aAClC;iBAAM;gBACH,KAAK,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC;aAClC;SACJ;QAED,UAAU;QACV,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;KAEhE;IAED,UAAU;IACV,IAAI,SAAS,YAAY,cAAc,EAAE;QACrC,IAAG,KAAK,CAAC,KAAK,KAAK,CAAC,EAAC;YACjB,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;YAC5C,KAAK,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;SACxD;QACD,IAAG,KAAK,CAAC,KAAK,KAAK,CAAC,EAAC;YACjB,KAAK,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;YACrD,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;SAClD;QACD,IAAG,KAAK,CAAC,KAAK,KAAK,CAAC,EAAC;YACjB,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;YAC5C,KAAK,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;SACxD;KACJ;IACD,4BAA4B;IAC5B,KAAK,CAAC,GAAG,CAAC,EAAC,IAAI,EAAE,SAAS,CAAC,IAAI,EAAE,GAAG,EAAE,SAAS,CAAC,GAAG,EAAC,CAAC,CAAC;IACtD,KAAK,CAAC,GAAG,CAAC,EAAC,MAAM,EAAE,SAAS,CAAC,YAAY,GAAG,SAAS,CAAC,aAAa,EAAC,CAAC,CAAC;IAEtE,YAAY;IACZ,KAAK,CAAC,IAAI,CAAC,aAAa,EAAE,SAAS,CAAC,MAAM,CAAC,CAAC;AAChD,CAAC;AAGD;IACI,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,CAAC;QAC1B,mBAAmB,CAAC,IAAI,EAAE,SAAS,EAAE,CAAC,CAAC,CAAC;IAC5C,CAAC,CAAC,CAAC;AACP,CAAC;AAED;IACI,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,CAAC;QACxB,mBAAmB,CAAC,IAAI,EAAE,MAAM,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC;IAC/C,CAAC,CAAC,CAAC;AACP,CAAC;AAED;IACI,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,CAAC;QAC3B,mBAAmB,CAAC,IAAI,EAAE,SAAS,EAAE,CAAC,CAAC,CAAC;IAC5C,CAAC,CAAC,CAAC;AACP,CAAC;AAGD;IACI,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,CAAC;QACvB,mBAAmB,CAAC,IAAI,EAAE,MAAM,EAAE,UAAU,EAAE,IAAI,CAAC,CAAC;IACxD,CAAC,CAAC,CAAC;AACP,CAAC;AAGD;IACI,KAAK,CAAC,UAAU,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,CAAC;QAC7B,mBAAmB,CAAC,IAAI,EAAE,aAAa,EAAE,CAAC,CAAC,CAAC;IAChD,CAAC,CAAC,CAAC;AACP,CAAC;AAED;IACI,oBAAoB,EAAE,CAAC;AAC3B,CAAC;AAID;IACI,0BAA0B,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC;IAC3C,0BAA0B,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;IACtC,0BAA0B,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;AAC3C,CAAC;AAED,mBAAmB,IAAY;IAC3B,CAAC,CAAC,WAAW,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;AAC/C,CAAC;AAGD,SAAS;AACT,kBAAkB,IAAc,EAAE,SAAiB,EAAE,EAAY,EAAE,WAA4B;IAA5B,iDAA4B;IAC3F,OAAO,CAAC,GAAG,CAAC,0BAA0B,EAAE,IAAI,EAAE,SAAS,EAAE,EAAE,CAAC,CAAC;IAE7D,gBAAgB;IAEhB,KAAK;IACL,IAAI,IAAU,CAAC;IACf,IAAG,IAAI,KAAK,SAAS,EAAC;QAClB,IAAI,GAAG,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;KAEhD;IACD,IAAG,IAAI,KAAK,MAAM,EAAC;QACf,IAAI,GAAG,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;KAC9C;IACD,IAAG,IAAI,KAAK,MAAM,EAAC;QACf,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;KAC7C;IACD,IAAG,IAAI,KAAK,aAAa,EAAC;QACtB,IAAI,GAAG,KAAK,CAAC,UAAU,CAAC,MAAM,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;KACnD;IAED,IAAI,QAAgB,CAAC;IACrB,IAAG,EAAE,KAAK,SAAS,EAAC;QAChB,QAAQ,GAAG,KAAK,CAAC,OAAO,CAAC;KAC5B;IACD,IAAG,EAAE,KAAK,MAAM,EAAC;QACb,QAAQ,GAAG,KAAK,CAAC,KAAK,CAAC;KAC1B;IACD,IAAG,EAAE,KAAK,MAAM,EAAC;QACb,QAAQ,GAAG,KAAK,CAAC,IAAI,CAAC;KACzB;IACD,IAAG,EAAE,KAAK,aAAa,EAAC;QACpB,QAAQ,GAAG,KAAK,CAAC,UAAU,CAAC;KAC/B;IACD,IAAG,WAAW,EAAC;QACX,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;KAC1B;SAAM;QACH,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KACvB;IAED,QAAQ;IACR,IAAG,IAAI,KAAK,SAAS,IAAI,EAAE,KAAK,MAAM,EAAC;QACnC,SAAS,CAAC,wDAAc,IAAI,CAAC,IAAI,CAAC,IAAM,CAAC,CAAC;KAC7C;SAAM,IAAG,IAAI,KAAK,MAAM,IAAI,EAAE,KAAK,MAAM,EAAC;QACvC,SAAS,CAAC,WAAI,IAAI,CAAC,IAAI,CAAC,IAAI,yCAAQ,CAAC,CAAC;KACzC;SAAM,IAAG,IAAI,KAAK,MAAM,IAAI,EAAE,KAAK,aAAa,EAAC;QAC9C,SAAS,CAAC,WAAI,IAAI,CAAC,IAAI,CAAC,IAAI,mCAAO,CAAC,CAAC;KACxC;SAAM;QACH,IAAI,cAAc,GAAG;YACjB,SAAS,EAAE,IAAI;YACf,MAAM,EAAE,IAAI;YACZ,MAAM,EAAE,GAAG;YACX,aAAa,EAAE,KAAK;SAEvB,CAAC;QAEF,SAAS,CAAI,cAAc,CAAC,IAAI,CAAC,oBAAK,IAAI,CAAC,IAAI,CAAC,IAAI,oBAAK,cAAc,CAAC,EAAE,CAAC,uBAAK,CAAC,CAAC;KACrF;IAGD,mBAAmB;IACnB,8BAA8B,CAAC,IAAI,CAAC,CAAC;IACrC,8BAA8B,CAAC,EAAE,CAAC,CAAC;IAEnC,OAAO;IACP,gBAAgB,EAAE,CAAC;IAEnB,OAAO;IACP,OAAO,IAAI,CAAC;AAChB,CAAC;AAGD,kBAAkB;AAClB,wCAAwC,MAAkB;IACtD,IAAI,KAAa,CAAC;IAClB,IAAG,MAAM,KAAK,SAAS,EAAC;QACpB,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC;KACzB;IACD,IAAG,MAAM,KAAK,MAAM,EAAC;QACjB,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC;KACvB;IACD,IAAG,MAAM,KAAK,MAAM,EAAC;QACjB,KAAK,GAAG,KAAK,CAAC,IAAI,CAAC;KACtB;IACD,IAAG,MAAM,KAAK,aAAa,EAAC;QACxB,KAAK,GAAG,KAAK,CAAC,UAAU,CAAC;KAC5B;IAED,WAAW;IACX,KAAK,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,CAAC;QAClB,IAAI,IAAI,GAAG,UAAU,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,YAAY,aAAa,IAAI,CAAC,CAAC,IAAI,KAAK,IAAI,EAA7C,CAA6C,CAAkB,CAAC;QAChG,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC;QACvB,IAAI,CAAC,SAAS,GAAG,CAAC,IAAI,CAAC,MAAM,KAAK,SAAS,IAAI,IAAI,CAAC,aAAa,KAAK,KAAK,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;QAEhG,cAAc;QACd,IAAG,MAAM,KAAK,MAAM,IAAI,MAAM,KAAK,MAAM,EAAC;YACtC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;SACtB;QACD,IAAG,MAAM,KAAK,SAAS,IAAI,MAAM,KAAK,aAAa,EAAC;YAChD,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;SACvB;QAED,IAAG,MAAM,KAAK,aAAa,EAAC;YACxB,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC;SACpB;QAED,IAAG,MAAM,KAAK,aAAa,EAAC;YACxB,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC;SACpB;IACL,CAAC,CAAC,CAAC;AACP,CAAC;AAED,kBAAkB;AAClB;IACI,IAAI,eAAe,GAAG,UAAU,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,YAAY,oBAAoB,EAAjC,CAAiC,CAAC,CAAC;IAChF,IAAI,UAAU,GAAG,CAAC,CAAC;IAEnB,qBAAqB;IACrB,KAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAC,EAAE,EAAC;QACnC,IAAI,IAAI,GAAG,eAAe,CAAC,UAAU,CAAyB,CAAC;QAC/D,IAAI,CAAC,MAAM,GAAG,UAAU,CAAC;QACzB,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC;QACvB,UAAU,EAAE,CAAC;KAChB;IAED,KAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,IAAI,EAAE,CAAC,EAAE,EAAC;QAC/B,IAAI,IAAI,GAAG,eAAe,CAAC,UAAU,CAAyB,CAAC;QAC/D,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC;QACvB,UAAU,EAAE,CAAC;KAChB;IAED,KAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,IAAI,EAAE,CAAC,EAAE,EAAC;QAC/B,IAAI,IAAI,GAAG,eAAe,CAAC,UAAU,CAAyB,CAAC;QAC/D,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC;QACvB,UAAU,EAAE,CAAC;KAChB;IAED,KAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,IAAI,EAAE,CAAC,EAAE,EAAC;QAC/B,IAAI,IAAI,GAAG,eAAe,CAAC,UAAU,CAAyB,CAAC;QAC/D,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC;QACvB,UAAU,EAAE,CAAC;KAChB;IAED,KAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,KAAK,EAAE,CAAC,EAAE,EAAC;QAChC,IAAI,IAAI,GAAG,eAAe,CAAC,UAAU,CAAyB,CAAC;QAC/D,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC;QACtB,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC;QACvB,UAAU,EAAE,CAAC;KAChB;IAED,KAAI,IAAI,MAAM,IAAI,KAAK,CAAC,YAAY,EAAE;QAClC,IAAG,KAAK,CAAC,YAAY,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE;YAC1C,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YAC5B,KAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,YAAY,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE,EAAC;gBAC/C,IAAI,IAAI,GAAG,eAAe,CAAC,UAAU,CAAyB,CAAC;gBAC/D,IAAI,CAAC,MAAM,GAAG,SAAS,CAAC;gBACxB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;gBACrB,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC;gBACvB,UAAU,EAAE,CAAC;aAChB;SACJ;KACJ;AACL,CAAC;AAED,UAAU;AACV,yBAAyB,IAAqB,EAAE,EAAmB,EAAE,MAAc,EAAE,KAAiB;IAAjB,iCAAiB;IAClG,OAAO,CAAC,GAAG,CAAC,mCAAmC,EAAE,IAAI,EAAE,EAAE,EAAE,KAAK,CAAC,CAAC;IAElE,gBAAgB;IAChB,IAAG,IAAI,KAAK,UAAU,EAAC;QACnB,IAAG,KAAK,CAAC,QAAQ,GAAG,KAAK;YAAE,OAAO,KAAK,CAAC,CAAC,cAAc;KAC1D;SAAM,IAAG,IAAI,KAAK,MAAM,EAAC;QACtB,IAAG,KAAK,CAAC,IAAI,GAAG,KAAK;YAAE,OAAO,KAAK,CAAC,CAAC,cAAc;KACtD;SAAM,IAAG,IAAI,KAAK,MAAM,EAAC;QACtB,IAAG,KAAK,CAAC,IAAI,GAAG,KAAK;YAAE,OAAO,KAAK,CAAC,CAAC,cAAc;KACtD;SAAM,IAAG,IAAI,KAAK,MAAM,EAAC;QACtB,IAAG,KAAK,CAAC,IAAI,GAAG,KAAK;YAAE,OAAO,KAAK,CAAC,CAAC,cAAc;KACtD;SAAM,IAAG,IAAI,KAAK,OAAO,EAAC;QACvB,IAAG,KAAK,CAAC,KAAK,GAAG,KAAK;YAAE,OAAO,KAAK,CAAC,CAAC,cAAc;KACvD;IACD,IAAG,EAAE,KAAK,UAAU,EAAC;QACjB,IAAG,CAAC,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,GAAG,EAAE;YAAE,OAAO,KAAK,CAAC,CAAC,kBAAkB;KACrE;SAAM,IAAG,EAAE,KAAK,MAAM,EAAC;QACpB,IAAG,CAAC,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC,GAAG,CAAC;YAAE,OAAO,KAAK,CAAC,CAAC,kBAAkB;KAChE;IAED,KAAK;IACL,IAAG,IAAI,KAAK,UAAU,EAAC;QACnB,KAAK,CAAC,QAAQ,IAAI,KAAK,CAAC;KAC3B;SAAM,IAAG,IAAI,KAAK,MAAM,EAAC;QACtB,KAAK,CAAC,IAAI,IAAI,KAAK,CAAC;KACvB;SAAM,IAAG,IAAI,KAAK,MAAM,EAAC;QACtB,KAAK,CAAC,IAAI,IAAI,KAAK,CAAC;KACvB;SAAM,IAAG,IAAI,KAAK,MAAM,EAAC;QACtB,KAAK,CAAC,IAAI,IAAI,KAAK,CAAC;KACvB;SAAM,IAAG,IAAI,KAAK,OAAO,EAAC;QACvB,KAAK,CAAC,KAAK,IAAI,KAAK,CAAC;KACxB;IAED,IAAG,EAAE,KAAK,UAAU,EAAC;QACjB,KAAK,CAAC,QAAQ,IAAI,KAAK,CAAC;KAC3B;SAAM,IAAG,EAAE,KAAK,MAAM,EAAC;QACpB,KAAK,CAAC,IAAI,IAAI,KAAK,CAAC;KACvB;SAAM,IAAG,EAAE,KAAK,MAAM,EAAC;QACpB,KAAK,CAAC,IAAI,IAAI,KAAK,CAAC;KACvB;SAAM,IAAG,EAAE,KAAK,MAAM,EAAC;QACpB,KAAK,CAAC,IAAI,IAAI,KAAK,CAAC;KACvB;SAAM,IAAG,EAAE,KAAK,OAAO,EAAC;QACrB,KAAK,CAAC,KAAK,IAAI,KAAK,CAAC;KACxB;SAAM,IAAG,EAAE,KAAK,SAAS,EAAC;QACvB,IAAG,KAAK,CAAC,YAAY,CAAC,MAAM,CAAC,KAAK,SAAS;YAAE,KAAK,CAAC,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;QAC5E,KAAK,CAAC,YAAY,CAAC,MAAM,CAAC,IAAI,KAAK,CAAC;KACvC;IACD,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;IAEnB,mBAAmB;IACnB,+BAA+B,EAAE,CAAC;IAElC,OAAO;IACP,gBAAgB,EAAE,CAAC;IAEnB,OAAO;IACP,OAAO,IAAI,CAAC;AAChB,CAAC;AAGD,sBAAsB,IAAY;IAC9B,CAAC,CAAC,6BAA6B,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC5C,gDAAgD;IAChD,CAAC,CAAC,gBAAgB,CAAC;SACd,KAAK,CAAC,EAAC,QAAQ,EAAE,KAAK,EAAC,CAAC;SACxB,KAAK,CAAC,MAAM,CAAC,CAAC;AACvB,CAAC;AACD,wBAAwB,IAAY,EAAE,cAAgE;IAClG,CAAC,CAAC,gCAAgC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC/C,gDAAgD;IAChD,CAAC,CAAC,cAAc,CAAC;SACZ,KAAK,CAAC,EAAC,QAAQ,EAAE,KAAK,EAAE,SAAS,EAAC,cAAc,EAAC,CAAC;SAClD,KAAK,CAAC,MAAM,CAAC,CAAC;AACvB,CAAC;AAED,MAAM;AACN,oBAAoB;AACpB,MAAM;AACN,sDAAsD;AACtD,oCAAoC;AACpC,0FAA0F;AAC1F,2DAA2D;AAC3D,QAAQ;AACR,IAAI;AAEJ;IACI,YAAY;IACZ,CAAC,CAAC,4BAA4B,CAAC,CAAC,KAAK,CAAC;QAClC,KAAK,EAAE,EAAC,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC,EAAC;QAC3B,MAAM,EAAE;YACJ,IAAG,YAAY,KAAK,IAAI;gBAAE,OAAO,KAAK,CAAC;QAC3C,CAAC;KACJ,CAAC,CAAC;AACP,CAAC;AAED,CAAC,CAAC;IAEE,eAAe;IACf,IAAM,MAAM,GAAG,EAAE,EAAE,CAAC;IAEpB,MAAM,CAAC,EAAE,CAAC,MAAM,EAAE,UAAC,OAAO;QACtB,OAAO,CAAC,GAAG,CAAC,mBAAmB,EAAE,OAAO,CAAC,CAAC;IAC9C,CAAC,CAAC,CAAC;IAGH,cAAc;IACd,OAAO,CAAC,GAAG,CAAC,+BAA+B,CAAC,CAAC;IAC7C,MAAM,CAAC,IAAI,CAAC,+BAA+B,EAAE,EAAC,OAAO,EAAE,MAAM,CAAC,OAAO,EAAE,IAAI,EAAE,MAAM,CAAC,IAAI,EAAC,CAAC,CAAC;IAC3F,kGAAkG;IAElG,0BAA0B;IAC1B,MAAM,CAAC,EAAE,CAAC,4BAA4B,EAAE,UAAC,kBAAkB;QACvD,CAAC,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;QACzD,CAAC,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;QAEzD,OAAO,CAAC,GAAG,CAAC,iBAAiB,EAAE,kBAAkB,CAAC,CAAC;QACnD,IAAI,KAAK,GAAG,IAAI,QAAQ,CAAC,KAAK,CAAC,kBAAkB,CAAC,CAAC;QACnD,IAAI,MAAM,GAAG,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAC1C,IAAI,YAAY,GAAG,KAAK,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAEtD,yBAAyB;QACzB,IAAG,MAAM,CAAC,UAAU,KAAK,IAAI,EAAC;YAC1B,IAAI,kBAAgB,GAAG,CAAC,MAAM,CAAC,IAAI,KAAK,IAAI,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC;YACpE,IAAI,wBAAwB,GAAG,CAAC,MAAM,CAAC,IAAI,KAAK,IAAI,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC;YAC5E,cAAc,CAAC,4JAAkC,kBAAgB,4HAA+B,EAAE,UAAC,KAAK;gBACpG,IAAI,UAAU,GAAG,CAAC,CAAC,oBAAoB,CAAC,CAAC,GAAG,EAAY,CAAC;gBACzD,IAAG,UAAU,KAAK,EAAE,EAAC;oBACjB,UAAU,GAAG,kBAAgB,CAAC;iBACjC;gBACD,MAAM,CAAC,IAAI,CAAC,mBAAmB,EAAE,EAAC,OAAO,EAAE,MAAM,CAAC,OAAO,EAAE,IAAI,EAAE,MAAM,CAAC,IAAI,EAAE,IAAI,EAAE,UAAU,EAAC,CAAC,CAAC;gBACjG,MAAM,CAAC,UAAU,GAAG,UAAU,CAAC;gBAC/B,CAAC,CAAC,CAAC,MAAM,CAAC,IAAI,KAAK,IAAI,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;gBAErE,YAAY,CAAC,yPAAiD,CAAC,CAAC;YACpE,CAAC,CAAC,CAAC;SACN;IACL,CAAC,CAAC,CAAC;IAEH,sBAAsB;IACtB,MAAM,CAAC,EAAE,CAAC,sBAAsB,EAAE,UAAC,kBAAsC;QACrE,IAAI,KAAK,GAAG,IAAI,QAAQ,CAAC,KAAK,CAAC,kBAAkB,CAAC,CAAC;QACnD,CAAC,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;QACjD,CAAC,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;IACrD,CAAC,CAAC,CAAC;IAEH,WAAW;IACX,CAAC,CAAC,uBAAuB,CAAC,CAAC,KAAK,CAAC,UAAC,CAAC;QAC/B,CAAC,CAAC,sBAAsB,CAAC,CAAC,KAAK,CAAC,EAAC,QAAQ,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,SAAS,EAAC;gBAC1E,CAAC,CAAC,oBAAoB,CAAC,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;YACpD,CAAC,EAAC,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;IACtB,CAAC,CAAC,CAAC;IAEH,WAAW;IACX,CAAC,CAAC,oBAAoB,CAAC,CAAC,KAAK,CAAC,UAAC,CAAC;QAC5B,IAAI,OAAO,GAAa,EAAE,CAAC;QAC3B,KAAI,IAAI,GAAG,IAAI,SAAS,EAAC;YACrB,IAAG,GAAG,CAAC,KAAK,CAAC,WAAW,CAAC,EAAC;gBACtB,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;aACrB;SACJ;QAED,OAAO,CAAC,OAAO,CAAC,UAAC,MAAM,EAAE,CAAC;YAEtB,IAAI,IAAI,GAAG,IAAI,IAAI,CAAC,MAAM,CAAC,CAAC;YAC5B,IAAI,IAAI,GAAG,IAAI,aAAa,EAAE,CAAC;YAC/B,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;YACjB,IAAI,CAAC,aAAa,GAAG,UAAQ,IAAI,CAAC,EAAI,CAAC;YACvC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;YACnB,IAAI,CAAC,GAAG,GAAG,CAAC,CAAC;YACb,IAAI,CAAC,IAAI,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC;YAE9B,CAAC,CAAC,uBAAuB,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC;YAEjD,yBAAyB,CAAC,IAAI,EAAE,CAAC,CAAC,MAAI,IAAI,CAAC,aAAe,CAAC,CAAC,CAAC;QACjE,CAAC,CAAC,CAAC;QAIH,IAAI,QAAQ,GAA6B,EAAC,QAAQ,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,MAAM,EAAE;gBACjF,QAAQ,EAAE,CAAC;YACf,CAAC;YACD,SAAS,EAAC;YAEV,CAAC,EAAC;QACF,CAAC,CAAC,mBAAmB,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;IACzD,CAAC,CAAC,CAAC;IAEH,OAAO;IACP,QAAQ,EAAE,CAAC;IACX,cAAc,EAAE,CAAC;IACjB,WAAW,EAAE,CAAC;IACd,SAAS,EAAE,CAAC;IACZ,YAAY,EAAE,CAAC;IACf,SAAS,EAAE,CAAC;IACZ,gBAAgB,EAAE,CAAC;IAEnB,8BAA8B,CAAC,SAAS,CAAC,CAAC;IAE1C,gBAAgB;IAChB,gBAAgB,EAAE,CAAC;IAEnB,YAAY;IACZ,QAAQ,EAAE,CAAC;IAEX,aAAa;IACb,IAAI,MAAM,GAAG;QACT,EAAC,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,QAAQ,EAAC;QAClC,EAAC,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,QAAQ,EAAC;QAClC,EAAC,IAAI,EAAE,UAAU,EAAE,KAAK,EAAE,OAAO,EAAC;QAClC,EAAC,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,QAAQ,EAAC;QAClC,EAAC,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,OAAO,EAAC;QACjC,EAAC,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,QAAQ,EAAC;KAErC;IACD,CAAC,CAAC,oBAAoB,CAAC,CAAC,QAAQ,CAAC;QAC7B,WAAW,EAAE,WAAW;QACxB,MAAM,EAAE,MAAM;KACjB,CAAC,CAAC;IACH,CAAC,CAAC,oBAAoB,CAAC,CAAC,QAAQ,CAAC;QAC7B,WAAW,EAAE,WAAW;QACxB,MAAM,EAAE,MAAM;KACjB,CAAC,CAAC;IAEH,CAAC,CAAC,8EAA8E,CAAC,CAAC,EAAE,CAAC,QAAQ,EAAE,UAAS,CAAC;QACrG,IAAI,OAAO,GAAG,CAAC,CAAC,uCAAuC,CAAC,CAAC,GAAG,EAAY,CAAC;QACzE,IAAI,OAAO,GAAG,CAAC,CAAC,uCAAuC,CAAC,CAAC,GAAG,EAAY,CAAC;QAEzE,IAAG,OAAO,KAAK,EAAE,IAAI,OAAO,KAAK,EAAE,EAAC;YAChC,CAAC,CAAC,uCAAuC,CAAC,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;SACtE;aAAM;YACH,CAAC,CAAC,uCAAuC,CAAC,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;SACnE;IACL,CAAC,CAAC,CAAC;IAEH,SAAS;IACT,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,WAAW,EAAE,yBAAyB,EAAE,UAAS,CAAC;QAC7D,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,KAAK,CAAC,CAAE,sCAAsC;QACnE,qGAAqG;QACrG,IAAI,EAAE,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC5B,IAAI,IAAI,GAAG,UAAU,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,CAAC,aAAa,KAAK,EAAE,EAAtB,CAAsB,CAAC,CAAC;QAExD,wCAAwC;QACxC,IAAG,IAAI,CAAC,MAAM,KAAK,MAAM,EAAC;YACtB,KAAK;YACL,CAAC,CAAC,4BAA4B,CAAC,CAAC,GAAG,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;YACrD,YAAY,GAAG,IAAI,CAAC;SACvB;QAED,IAAG,IAAI,CAAC,MAAM,KAAK,SAAS,EAAC;YACzB,KAAK;YACL,CAAC,CAAC,+BAA+B,CAAC,CAAC,GAAG,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;YACxD,YAAY,GAAG,IAAI,CAAC;SACvB;QAED,IAAG,IAAI,CAAC,MAAM,KAAK,MAAM,EAAC;YACtB,OAAO;YACP,CAAC,CAAC,4BAA4B,CAAC,CAAC,GAAG,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;YACrD,YAAY,GAAG,IAAI,CAAC;SACvB;QAED,IAAG,IAAI,CAAC,MAAM,KAAK,aAAa,EAAC;YAC7B,MAAM;YACN,CAAC,CAAC,mCAAmC,CAAC,CAAC,GAAG,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;YAC5D,YAAY,GAAG,IAAI,CAAC;SACvB;QAED,IAAG,IAAI,CAAC,MAAM,KAAK,UAAU,EAAC;YAC1B,KAAK;YACL,CAAC,CAAC,oDAAoD,CAAC,CAAC,GAAG,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;YAC7E,YAAY,GAAG,IAAI,CAAC;SACvB;QACD,IAAG,IAAI,CAAC,MAAM,KAAK,MAAM,EAAC;YACtB,MAAM;YACN,CAAC,CAAC,gDAAgD,CAAC,CAAC,GAAG,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;YACzE,YAAY,GAAG,IAAI,CAAC;SACvB;QACD,IAAG,IAAI,CAAC,MAAM,KAAK,MAAM,EAAC;YACtB,MAAM;YACN,CAAC,CAAC,gDAAgD,CAAC,CAAC,GAAG,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;YACzE,YAAY,GAAG,IAAI,CAAC;YAEpB,wBAAwB;YACxB,CAAC,CAAC,oBAAoB,CAAC,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;SACjD;QAED,IAAG,IAAI,CAAC,MAAM,KAAK,MAAM,EAAC;YACtB,MAAM;YACN,CAAC,CAAC,gDAAgD,CAAC,CAAC,GAAG,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;YACzE,YAAY,GAAG,IAAI,CAAC;SACvB;QAED,IAAG,IAAI,CAAC,MAAM,KAAK,OAAO,EAAC;YACvB,MAAM;YACN,CAAC,CAAC,iDAAiD,CAAC,CAAC,GAAG,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;YAC1E,YAAY,GAAG,IAAI,CAAC;SACvB;QAED,OAAO,CAAC,GAAG,CAAC,gBAAgB,EAAE,YAAY,CAAC,CAAC;QAE5C,CAAC,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;IAErC,CAAC,CAAC,CAAC;IAEH;QACI,mCAAmC;QACnC,IAAG,CAAC,2BAA2B,EAAC;YAC5B,CAAC,CAAC,aAAa,CAAC,CAAC,GAAG,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;YACvC,CAAC,CAAC,iBAAiB,CAAC,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;SAC5C;QAED,CAAC,CAAC,iBAAiB,CAAC,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,IAAI,CAAC,CAAC;QAC3C,YAAY,GAAG,IAAI,CAAC;IACxB,CAAC;IAED,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,SAAS,EAAE,yBAAyB,EAAE,UAAS,CAAC;QAC3D,OAAO,CAAC,GAAG,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;QAC7B,gBAAgB,EAAE,CAAC;IAEvB,CAAC,CAAC,CAAC;IACH,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,UAAU,EAAE,YAAY,EAAE,UAAS,CAAC;QAC/C,IAAI,CAAC,CAAC,cAAc,EAAE;YAClB,CAAC,CAAC,cAAc,EAAE,CAAC,CAAC,gCAAgC;SACvD;QACD,qFAAqF;QAErF,OAAO,KAAK,CAAC;IACjB,CAAC,CAAC,CAAC;IAEH,eAAe;IACf,CAAC,CAAC,iBAAiB,CAAC,CAAC,EAAE,CAAC,WAAW,EAAE,UAAS,CAAC;QAC3C,OAAO,CAAC,GAAG,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;QAC/B,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,0BAA0B,CAAC,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;IACjE,CAAC,CAAC,CAAC;IAEH,CAAC,CAAC,iBAAiB,CAAC,CAAC,EAAE,CAAC,WAAW,EAAE,UAAS,CAAC;QAC3C,OAAO,CAAC,GAAG,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;QAC/B,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,0BAA0B,CAAC,CAAC,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAE,8CAA8C;IACpH,CAAC,CAAC,CAAC;IACH,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,WAAW,EAAE,qBAAqB,EAAE,UAAS,CAAC;QACzD,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;IAChC,CAAC,CAAC,CAAC;IACH,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,WAAW,EAAE,qBAAqB,EAAE,UAAS,CAAC;QACzD,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAE,8CAA8C;IACnF,CAAC,CAAC,CAAC;IAGH,IAAI,gBAA2B,CAAC;IAChC,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,MAAM,EAAE,2BAA2B,EAAE,UAAS,CAAC;QAC1D,6CAA6C;QAC7C,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;QAC1B,IAAI,KAAK,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC;QAEpB,IAAI,CAAC,CAAC,eAAe,EAAE;YACnB,CAAC,CAAC,eAAe,EAAE,CAAC,CAAC,sCAAsC;SAC9D;QAED,YAAY;QACZ,IAAI,EAAc,CAAC;QACnB,IAAG,KAAK,CAAC,EAAE,CAAC,YAAY,CAAC;YAAE,EAAE,GAAG,MAAM,CAAC;QACvC,IAAG,KAAK,CAAC,EAAE,CAAC,YAAY,CAAC;YAAE,EAAE,GAAG,MAAM,CAAC;QACvC,IAAG,KAAK,CAAC,EAAE,CAAC,mBAAmB,CAAC;YAAE,EAAE,GAAG,aAAa,CAAC;QACrD,IAAG,KAAK,CAAC,EAAE,CAAC,eAAe,CAAC;YAAE,EAAE,GAAG,SAAS,CAAC;QAC7C,IAAG,KAAK,CAAC,EAAE,CAAC,gBAAgB,CAAC;YAAE,EAAE,GAAG,UAAU,CAAC;QAC/C,IAAG,KAAK,CAAC,EAAE,CAAC,YAAY,CAAC;YAAE,EAAE,GAAG,MAAM,CAAC;QACvC,IAAG,KAAK,CAAC,EAAE,CAAC,YAAY,CAAC;YAAE,EAAE,GAAG,MAAM,CAAC;QACvC,IAAG,KAAK,CAAC,EAAE,CAAC,YAAY,CAAC;YAAE,EAAE,GAAG,MAAM,CAAC;QACvC,IAAG,KAAK,CAAC,EAAE,CAAC,aAAa,CAAC;YAAE,EAAE,GAAG,OAAO,CAAC;QACzC,IAAG,KAAK,CAAC,EAAE,CAAC,WAAW,CAAC;YAAE,EAAE,GAAG,SAAS,CAAC;QAEzC,IAAG,YAAY,KAAK,IAAI,EAAC;YACrB,iBAAiB;YACjB,IAAG,EAAE,KAAK,SAAS,EAAC;gBAChB,gBAAgB,GAAG,YAAY,CAAC;gBAChC,2BAA2B,GAAG,IAAI,CAAC;gBACnC,CAAC,CAAC,0BAA0B,CAAC,CAAC,WAAW,CAAC,EAAC,CAAC,EAAE,CAAC,CAAC,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC,KAAK,EAAC,CAAC,CAAC;gBACpE,OAAO,KAAK,CAAC;aAChB;iBAAM;gBACH,cAAc;gBACd,IAAG,YAAY,YAAY,aAAa,EAAC;oBACrC,QAAQ,CAAC,YAAY,CAAC,MAAkB,EAAE,YAAY,CAAC,aAAa,EAAE,EAAc,CAAC,CAAC;oBACtF,OAAO,KAAK,CAAC;iBAChB;gBAED,IAAG,YAAY,YAAY,oBAAoB,EAAC;oBAC5C,IAAI,MAAM,GAAW,IAAI,CAAC;oBAC1B,IAAG,EAAE,KAAK,SAAS,EAAC;wBAChB,MAAM,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;qBACzC;oBACD,eAAe,CAAC,YAAY,CAAC,MAAyB,EAAE,EAAqB,EAAE,MAAM,CAAC,CAAC;oBACvF,OAAO,KAAK,CAAC;iBAChB;aACJ;SAIJ;QAED,OAAO,KAAK,CAAC;IACjB,CAAC,CAAC,CAAC;IAEH,WAAW;IACX;QACI,IAAI,OAAO,GAAG,UAAU,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,YAAY,cAAc,EAA3B,CAA2B,CAAmB,CAAC;QAClF,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QAC9B,gBAAgB,EAAE,CAAC;IACvB,CAAC;IACD,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,OAAO,EAAE,mCAAmC,EAAE,UAAS,CAAC;QACnE,CAAC,CAAC,cAAc,EAAE,CAAC;QACnB,SAAS,CAAC,0CAAY,CAAC;QACvB,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC;QAChB,YAAY,EAAE,CAAC;QAEf,OAAO,KAAK,CAAC;IACjB,CAAC,CAAC,CAAC;IACH,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,OAAO,EAAE,mCAAmC,EAAE,UAAS,CAAC;QACnE,CAAC,CAAC,cAAc,EAAE,CAAC;QACnB,IAAG,KAAK,CAAC,KAAK,KAAK,CAAC,EAAC;YACjB,SAAS,CAAC,0CAAY,CAAC,CAAC;SAC3B;aAAM;YACH,SAAS,CAAC,0CAAY,CAAC,CAAC;SAC3B;QACD,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC;QAChB,YAAY,EAAE,CAAC;QAEf,OAAO,KAAK,CAAC;IACjB,CAAC,CAAC,CAAC;IACH,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,OAAO,EAAE,mCAAmC,EAAE,UAAS,CAAC;QACnE,CAAC,CAAC,cAAc,EAAE,CAAC;QACnB,SAAS,CAAC,0CAAY,CAAC;QACvB,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC;QAChB,YAAY,EAAE,CAAC;QAEf,OAAO,KAAK,CAAC;IACjB,CAAC,CAAC,CAAC;IAEH,OAAO;IACP,CAAC,CAAC,sBAAsB,CAAC,CAAC,EAAE,CAAC,OAAO,EAAE,UAAS,CAAC;QAC5C,CAAC,CAAC,aAAa,CAAC,CAAC,MAAM,EAAE,CAAC;IAC9B,CAAC,CAAC,CAAC;IAEH,QAAQ;IACR,CAAC,CAAC,kBAAkB,CAAC,CAAC,EAAE,CAAC,OAAO,EAAE;QAC9B,CAAC,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;IACjC,CAAC,CAAC,CAAC;IAEH,aAAa;IACb,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,UAAU,EAAE,gCAAgC,EAAE,UAAS,CAAC;QACnE,CAAC,CAAC,cAAc,EAAE,CAAC;QACnB,IAAI,SAAS,GAAG,CAAC,CAAC,gCAAgC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QAChE,OAAO,CAAC,GAAG,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;QAEvC,IAAI,IAAI,GAAG,KAAK,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;QACrC,IAAI,IAAI,GAAG,UAAU,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,YAAY,aAAa,IAAI,CAAC,CAAC,IAAI,KAAK,KAAK,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAlE,CAAkE,CAAkB,CAAC;QAErH,IAAG,IAAI,CAAC,IAAI,EAAC;YACT,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC;YAClB,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;SACvB;aAAM;YACH,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;YACjB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;SACtB;QAED,gBAAgB,EAAE,CAAC;QAGnB,OAAO,KAAK,CAAC;IACjB,CAAC,CAAC,CAAC;IAEH,6DAA6D;IAC7D,qDAAqD;IAErD,sBAAsB;IACtB,6DAA6D;IAE7D,yBAAyB;IACzB,sEAAsE;IACtE,MAAM;IACN,6DAA6D;IAC7D,qDAAqD;IACrD,uDAAuD;IACvD,MAAM;IAEN,aAAa;IACb,CAAC,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,0CAA0C,CAAC,CAAC;IAC/D,CAAC,CAAC,WAAW,CAAC;QACV,OAAO,EAAE,QAAQ;QACjB,QAAQ,EAAE,0BAA0B;QACpC,QAAQ,EAAE,UAAS,GAAW;YAC1B,IAAG,GAAG,KAAK,KAAK,EAAC;gBACb,QAAQ,CAAC,MAAM,EAAE,gBAAgB,CAAC,aAAa,EAAE,SAAS,CAAC,CAAC;aAC/D;YACD,IAAG,GAAG,KAAK,QAAQ,EAAC;gBAChB,QAAQ,CAAC,MAAM,EAAE,gBAAgB,CAAC,aAAa,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC;aACrE;QACL,CAAC;QACD,MAAM,EAAE;YACJ,IAAI,EAAE,UAAS,OAAO;gBAClB,2BAA2B,GAAG,KAAK,CAAC;gBACpC,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;gBACrB,gBAAgB,EAAE,CAAC;YACvB,CAAC;SACJ;QACD,KAAK,EAAE;YACH,KAAK,EAAE,EAAC,IAAI,EAAE,MAAM,EAAC;YACrB,QAAQ,EAAE,EAAC,IAAI,EAAE,MAAM,EAAC;YACxB,KAAK,EAAE,MAAM;YACb,QAAQ,EAAE,EAAC,IAAI,EAAE,OAAO,EAAC;SAC5B;KACJ,CAAC,CAAC;IACH,cAAc;IACd,CAAC,CAAC,WAAW,CAAC;QACV,QAAQ,EAAE,uCAAuC;QACjD,QAAQ,EAAE,UAAS,GAAW;YAC1B,IAAG,GAAG,KAAK,MAAM,EAAC;gBACd,QAAQ,CAAC,SAAS,EAAE,CAAC,EAAE,MAAM,CAAC,CAAC;aAClC;YACD,IAAG,GAAG,KAAK,WAAW,IAAI,GAAG,KAAK,wBAAwB,EAAC;gBACvD,wBAAwB;gBACxB,KAAK,CAAC,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;gBACjE,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,UAAS,IAAI,EAAE,CAAC;oBAC/B,IAAG,IAAI,CAAC,WAAW,KAAK,SAAS,IAAI,IAAI,CAAC,WAAW,KAAK,CAAC,EAAC;wBACxD,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;wBACzB,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC;qBAC7B;gBACL,CAAC,CAAC,CAAC;gBACH,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,UAAC,CAAC,IAAK,QAAC,KAAK,SAAS,EAAf,CAAe,CAAC,CAAC;gBACvD,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;gBAEvC,8BAA8B,CAAC,SAAS,CAAC,CAAC;gBAC1C,8BAA8B,CAAC,MAAM,CAAC,CAAC;gBACvC,8BAA8B,CAAC,aAAa,CAAC,CAAC;gBAG9C,IAAG,GAAG,KAAK,WAAW;oBAAE,eAAe,CAAC,MAAM,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;gBAC9D,gBAAgB,EAAE,CAAC;gBACnB,SAAS,CAAC,oBAAK,CAAC,CAAC;aACpB;QACL,CAAC;QACD,KAAK,EAAE;YACH,MAAM,EAAE,EAAC,IAAI,EAAE,MAAM,EAAE,QAAQ,EAAE,cAAM,YAAK,CAAC,OAAO,CAAC,MAAM,KAAK,CAAC,EAA1B,CAA0B,EAAC;YAClE,MAAM,EAAE,WAAW;YACnB,WAAW,EAAE,EAAC,IAAI,EAAE,OAAO,EAAE,QAAQ,EAAE,cAAM,YAAK,CAAC,IAAI,KAAK,CAAC,EAAhB,CAAgB,EAAC;YAC9D,wBAAwB,EAAE,EAAC,IAAI,EAAE,iBAAiB,EAAC;SACtD;KACJ,CAAC,CAAC;IAEH,eAAe;IACf,CAAC,CAAC,WAAW,CAAC;QACV,QAAQ,EAAE,wBAAwB;QAClC,QAAQ,EAAE,UAAS,GAAW;QAC9B,CAAC;QACD,KAAK,EAAE;YACH,QAAQ,EAAE,EAAC,IAAI,EAAE,OAAO,EAAC;YACzB,MAAM,EAAE,WAAW;YACnB,QAAQ,EAAE,EAAC,IAAI,EAAE,OAAO,EAAC;SAC5B;KACJ,CAAC,CAAC;IACH,gBAAgB;IAChB,CAAC,CAAC,WAAW,CAAC;QACV,QAAQ,EAAE,sBAAsB;QAChC,KAAK,EAAE,UAAS,KAAa,EAAE,KAAwB;YACnD,cAAc;YACd,IAAI,MAAM,GAAG,KAAK,CAAC,IAAI,CAAC,aAAa,CAAoB,CAAC;YAC1D,IAAI,UAAU,GAAG,CAAC,CAAC;YACnB,IAAG,MAAM,KAAK,UAAU,EAAC;gBACrB,UAAU,GAAG,KAAK,CAAC,QAAQ,CAAC;aAC/B;YACD,IAAG,MAAM,KAAK,MAAM,EAAC;gBACjB,UAAU,GAAG,KAAK,CAAC,IAAI,CAAC;aAC3B;YACD,IAAG,MAAM,KAAK,MAAM,EAAC;gBACjB,UAAU,GAAG,KAAK,CAAC,IAAI,CAAC;aAC3B;YACD,IAAG,MAAM,KAAK,MAAM,EAAC;gBACjB,UAAU,GAAG,KAAK,CAAC,IAAI,CAAC;aAC3B;YACD,IAAG,MAAM,KAAK,OAAO,EAAC;gBAClB,UAAU,GAAG,KAAK,CAAC,KAAK,CAAC;aAC5B;YAED,IAAI,KAAK,GAAG,EAAE,CAAC;YACf,IAAI,YAAY,GAAG;gBACf,EAAC,GAAG,EAAE,gBAAgB,EAAE,IAAI,EAAE,OAAO,EAAE,MAAM,EAAE,UAAU,EAAC;gBAC1D,EAAC,GAAG,EAAE,YAAY,EAAE,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE,MAAM,EAAC;gBACnD,EAAC,GAAG,EAAE,YAAY,EAAE,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE,MAAM,EAAC;gBACnD,EAAC,GAAG,EAAE,YAAY,EAAE,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE,MAAM,EAAC;gBACnD,EAAC,GAAG,EAAE,aAAa,EAAE,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE,OAAO,EAAC;aACxD,CAAC;YACF,YAAY,CAAC,OAAO,CAAC,UAAC,IAAI;gBACtB,IAAG,MAAM,KAAK,IAAI,CAAC,MAAM;oBAAE,OAAO,IAAI,CAAC;gBAEvC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,EAAC,IAAI,EAAE,IAAI,CAAC,IAAI,EAAE,KAAK,EAAE,EAAE,EAAC,CAAC;gBAC/C,KAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,UAAU,EAAE,CAAC,EAAE,EAAC;oBAChC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,GAAG,EAAC,IAAI,EAAK,CAAC,WAAG,EAAC,CAAC;iBACzD;gBACD,OAAO,IAAI,CAAC;YAChB,CAAC,CAAC,CAAC;YACH,KAAK,CAAC,MAAM,CAAC,GAAI,WAAW,CAAC;YAC7B,KAAK,CAAC,QAAQ,CAAC,GAAI,EAAC,IAAI,EAAE,OAAO,EAAC,CAAC;YAGnC,OAAO;gBACH,QAAQ,EAAE,UAAS,GAAW;gBAC9B,CAAC;gBACD,KAAK,EAAE,KAAK;aACf;YAID,WAAW;YACX,wCAAwC;YACxC,SAAS;YACT,eAAe;YACf,oBAAoB;YACpB,2BAA2B;YAC3B,uBAAuB;YACvB,4BAA4B;YAC5B,oCAAoC;YACpC,+BAA+B;YAC/B,6CAA6C;YAC7C,6CAA6C;YAC7C,6CAA6C;YAC7C,wBAAwB;YACxB,oBAAoB;YACpB,gBAAgB;YAChB,aAAa;YACb,+BAA+B;YAC/B,qCAAqC;YACrC,QAAQ;YACR,IAAI;QAER,CAAC;KACJ,CAAC,CAAC;IAGH,mCAAmC;IACnC,8CAA8C;IAC9C,6DAA6D;IAC7D,0BAA0B;IAC1B,0BAA0B;IAC1B,oCAAoC;IACpC,MAAM;IAEN,2CAA2C;IAC3C,uBAAuB;IACvB,2BAA2B;IAC3B,0BAA0B;IAC1B,kCAAkC;IAClC,yCAAyC;IACzC,MAAM;IAEN,mDAAmD;IACnD,qHAAqH;IACrH,0BAA0B;IAC1B,0BAA0B;IAC1B,0BAA0B;IAC1B,0BAA0B;IAC1B,MAAM;IAEN,+CAA+C;IAC/C,iHAAiH;IACjH,kHAAkH;IAClH,0BAA0B;IAC1B,8GAA8G;IAC9G,0BAA0B;IAC1B,yBAAyB;IACzB,MAAM;IAEN,+CAA+C;IAC/C,8BAA8B;IAC9B,mHAAmH;IACnH,0BAA0B;IAC1B,8GAA8G;IAC9G,yBAAyB;IACzB,0BAA0B;IAC1B,mCAAmC;IACnC,MAAM;IAEN,+CAA+C;IAC/C,oHAAoH;IACpH,0BAA0B;IAC1B,8GAA8G;IAC9G,0BAA0B;IAC1B,yBAAyB;IACzB,MAAM;IAEN,gDAAgD;IAChD,6BAA6B;IAC7B,0BAA0B;IAC1B,+GAA+G;IAC/G,+GAA+G;IAC/G,yBAAyB;IACzB,MAAM;IAER,CAAC;AACH,CAAC,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;ACn1CH;IAGI,eAAY,IAAgB;QACxB,IAAG,IAAI,KAAK,SAAS,EAAC;YAClB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;SACpB;aAAM;YACH,IAAI,CAAC,IAAI,GAAG,IAAI,SAAS,EAAE,CAAC;SAC/B;IACL,CAAC;IAED,yBAAS,GAAT,UAAU,IAAU;QAChB,IAAG,IAAI,KAAK,IAAI,EAAC;YACb,OAAO,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;SAC3B;aAAM,IAAG,IAAI,KAAK,IAAI,EAAC;YACpB,OAAO,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;SAC3B;QACD,OAAO,IAAI,CAAC;IAChB,CAAC;IAED,+BAAe,GAAf,UAAgB,IAAU;QACtB,IAAG,IAAI,KAAK,IAAI,EAAC;YACb,OAAO,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;SAC3B;aAAM,IAAG,IAAI,KAAK,IAAI,EAAC;YACpB,OAAO,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;SAC3B;QACD,OAAO,IAAI,CAAC;IAChB,CAAC;IACL,YAAC;AAAD,CAAC;AA5BY,sBAAK;AA8BlB;IAYI;QAXA,gBAAW,GAAG,CAAC,CAAC;QAEhB,aAAQ,GAAW,EAAE,CAAC;QACtB,SAAI,GAAW,CAAC,CAAC;QAEjB,cAAS,GAAgB,EAAE,CAAC;QAC5B,YAAO,GAAgB,EAAE,CAAC;QAMtB,IAAI,CAAC,MAAM,GAAG,IAAI,SAAS,EAAE,CAAC;QAC9B,IAAI,CAAC,MAAM,GAAG,IAAI,SAAS,EAAE,CAAC;IAClC,CAAC;IACL,gBAAC;AAAD,CAAC;AAhBY,8BAAS;AAkBtB;IAAA;QACI,eAAU,GAAW,IAAI,CAAC;QAE1B,YAAO,GAAa,IAAI,CAAC;QAEzB,SAAI,GAAW,CAAC,CAAC;QACjB,SAAI,GAAW,EAAE,CAAC;QAClB,UAAK,GAAW,CAAC,CAAC;QAElB,UAAK,GAAW,CAAC,CAAC;QAElB,YAAO,GAAW,EAAE,CAAC;QACrB,UAAK,GAAW,EAAE,CAAC;QACnB,SAAI,GAAW,EAAE,CAAC;QAClB,eAAU,GAAW,EAAE,CAAC;IAC5B,CAAC;IAAD,gBAAC;AAAD,CAAC;AAfY,8BAAS;AAiBtB;IAAA;IAGA,CAAC;IAAD,gBAAC;AAAD,CAAC;AAHY,8BAAS;AAKtB;IAAA;IAGA,CAAC;IAAD,WAAC;AAAD,CAAC;AAHY,oBAAI;AAKjB;IAAiC,+BAAI;IAArC;QAAA,qEAEC;QADG,UAAI,GAAY,KAAK,CAAC;;IAC1B,CAAC;IAAD,kBAAC;AAAD,CAAC,CAFgC,IAAI,GAEpC;AAFY,kCAAW","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/main.ts\");\n","import * as sakuraba from './sakuraba';\r\n\r\ndeclare var params: {\r\n    boardId: string;\r\n    side: \"p1\" | \"p2\" | \"watch\";\r\n}\r\n\r\n// 独自型\r\ntype SakuraTokenArea = \"aura\" | \"life\" | \"flair\" | \"distance\" | \"dust\" | \"on-card\";\r\ntype CardArea = \"library\" | \"hand\" | \"used\" | \"hidden-used\" | \"special\";\r\ntype RegionName = SakuraTokenArea | CardArea | \"vigor\";\r\ntype CardType = \"attack\" | \"reaction\" | \"action\" | \"fullpower\" | \"enhance\";\r\ntype CardBaseType = 'normal' | 'special';\r\n\r\n// カード情報\r\n\r\ninterface CardDataItem {\r\n    name: string;\r\n    ruby?: string;\r\n    baseType: CardBaseType;\r\n    types: CardType[];\r\n    range?: string;\r\n    damage?: string;\r\n    capacity?: string;\r\n    cost?: string;\r\n    text: string;\r\n}\r\nconst CARD_DATA: {[key: string]: CardDataItem} = {\r\n      '01-yurina-o-n-1': {name: '斬', ruby: 'ざん', baseType: 'normal', types: ['attack'], range: \"3-4\", damage: '3/1', text: ''}\r\n    , '01-yurina-o-n-2': {name: '一閃', ruby: 'いっせん', baseType: 'normal', types: ['attack'], range: \"3\", damage: '2/2', text: '【常時】決死-あなたのライフが3以下ならば、この《攻撃》は+1/+0となる。'}\r\n    , '01-yurina-o-n-3': {name: '柄打ち', ruby: 'つかうち', baseType: 'normal', types: ['attack'], range: \"1-2\", damage: '2/1', text: '【攻撃後】決死-あなたのライフが3以下ならば、このターンにあなたが次に行う《攻撃》は+1/+0となる。'}\r\n    , '01-yurina-o-n-4': {name: '居合', ruby: 'いあい', baseType: 'normal', types: ['attack', 'fullpower'], range: \"3-4\", damage: '4/3', text: ''}\r\n    , '01-yurina-o-n-5': {name: '足捌き', ruby: 'あしさばき', baseType: 'normal', types: ['action'], text: '現在の間合が4以上ならば、間合→ダスト：2'}\r\n    , '01-yurina-o-n-6': {name: '圧気', ruby: 'あっき', baseType: 'normal', types: ['enhance'], capacity: '4', text: '隙\\n【破棄時】攻撃『適正距離1-4、3/-』を行う。'}\r\n    , '01-yurina-o-n-7': {name: '気炎万丈', ruby: 'きえんばんじょう', baseType: 'normal', types: ['enhance', 'fullpower'], capacity: '2', text: '【展開中】決死-あなたのライフが3以下ならば、あなたの他のメガミによる《攻撃》は+1/+1となるとともに超克を得る。'}\r\n    , '01-yurina-o-s-1': {name: '月影落', ruby: 'つきかげおとし', baseType: 'special', cost: '7', types: ['attack'], range: '3-4', damage: '4/4', text: ''}\r\n    , '01-yurina-o-s-2': {name: '浦波嵐', ruby: 'うらなみあらし', baseType: 'special', cost: '3', types: ['attack', 'reaction'], range: '0-10', damage: '2/-', text: '【攻撃後】対応した《攻撃》は-2/+0となる。'}\r\n    , '01-yurina-o-s-3': {name: '浮舟宿', ruby: 'うきふねやどし', baseType: 'special', cost: '3', types: ['action'], text: 'ダスト→自オーラ：5 \\n【再起】決死-あなたのライフが3以下である。'}\r\n    , '01-yurina-o-s-4': {name: '天音揺波の底力', ruby: 'あまねゆりなのそこぢから', baseType: 'special', cost: '5', types: ['attack', 'fullpower'], range: '1-4', damage: '5/5', text: '【常時】決死-あなたのライフが3以下でないと、このカードは使用できない。'}\r\n};\r\n\r\n\r\n// クラス\r\nclass Card {\r\n    id: string;\r\n    used?: boolean; // 切札にある場合のみ\r\n    sakuraToken?: number; // 捨て札にある場合のみ\r\n    type: string;\r\n\r\n    constructor(id: string){\r\n        this.id = id;\r\n    }\r\n\r\n    get data(): CardDataItem{\r\n        return CARD_DATA[this.id];\r\n    }\r\n}\r\n\r\nclass Layouter {\r\n    // 横に並んだカードやトークンをレイアウトする\r\n    static exec(selector: string, frameWidth: number, spacing: number = 8, padding: number = 4){\r\n        let $elems = $(selector);\r\n        let itemWidth = $elems.outerWidth();\r\n\r\n        $elems.each(function(i, elem){\r\n            $(elem).css('left', `${padding + (itemWidth + spacing) * i}px`).css('top', `${padding}px`);\r\n        });\r\n    }\r\n}\r\n\r\nabstract class Component {\r\n\r\n    region: RegionName;\r\n    indexOfRegion: number;\r\n    draggable: boolean = true;\r\n    rotated: number = 0;\r\n\r\n    oldRegion: RegionName;\r\n    oldIndexOfRegion: number;\r\n    oldDraggable: boolean;\r\n    oldRotated: number;\r\n\r\n    left: number = 0;\r\n    top: number = 0;\r\n\r\n    drawn: boolean = false;\r\n\r\n    htmlElementId: string;\r\n\r\n    abstract toHtml(): string;\r\n\r\n    /**\r\n     * 位置が変更されていればtrue\r\n     */\r\n    isLocationChanged(): boolean{\r\n        return this.region !== this.oldRegion\r\n        || this.indexOfRegion !== this.oldIndexOfRegion\r\n        || this.draggable !== this.oldDraggable\r\n        || this.rotated !== this.oldRotated\r\n    }\r\n\r\n    updateLocation(): void{\r\n        this.oldRegion = this.region;\r\n        this.oldIndexOfRegion = this.indexOfRegion;\r\n        this.oldDraggable = this.draggable;\r\n        this.oldRotated = this.rotated;\r\n    }\r\n\r\n    get zIndexOffset(): number {\r\n        return 0;\r\n    }\r\n}\r\n\r\nclass CardComponent extends Component {\r\n    card: Card;\r\n    opened: boolean = false;\r\n    oldOpened: boolean;\r\n\r\n    toHtml(): string{\r\n        return(`<div class=\"fbs-card\" draggable=\"true\" id=\"${this.htmlElementId}\" data-card-id=\"${this.card.id}\" data-html=\"${this.getDescriptionHtml()}\"></div>`);\r\n    }\r\n\r\n    isLocationChanged(): boolean{\r\n        return super.isLocationChanged() || this.opened !== this.oldOpened;\r\n    }\r\n\r\n    updateLocation(): void{\r\n        super.updateLocation();\r\n        this.oldOpened = this.opened;\r\n    }\r\n\r\n    getDescriptionHtml(): string{\r\n        let cardTitleHtml = `<ruby><rb>${this.card.data.name}</rb><rp>(</rp><rt>${this.card.data.ruby}</rt><rp>)</rp></ruby>`\r\n        let html = `<div class='ui header' style='margin-right: 2em;'>${cardTitleHtml}`\r\n\r\n        html += `</div><div class='ui content'>`\r\n\r\n        let typeCaptions = [];\r\n        if(this.card.data.types.indexOf('attack') >= 0) typeCaptions.push(\"<span style='color: red; font-weight: bold;'>攻撃</span>\");\r\n        if(this.card.data.types.indexOf('action') >= 0) typeCaptions.push(\"<span style='color: blue; font-weight: bold;'>行動</span>\");\r\n        if(this.card.data.types.indexOf('enhance') >= 0) typeCaptions.push(\"<span style='color: green; font-weight: bold;'>付与</span>\");\r\n        if(this.card.data.types.indexOf('reaction') >= 0) typeCaptions.push(\"<span style='color: purple; font-weight: bold;'>対応</span>\");\r\n        if(this.card.data.types.indexOf('fullpower') >= 0) typeCaptions.push(\"<span style='color: gold; font-weight: bold;'>全力</span>\");\r\n        html += `${typeCaptions.join('/')}`;\r\n        if(this.card.data.range !== undefined){\r\n            html += `<span style='margin-left: 1em;'>${this.card.data.range}</span>`\r\n        }\r\n        html += `<br>`;\r\n        if(this.card.data.baseType === 'special'){\r\n            html += `<div class='ui top right attached label'>${this.card.data.cost}</div>`;\r\n        }\r\n        if(this.card.data.types.indexOf('enhance') >= 0){\r\n            html += `納: ${this.card.data.capacity}<br>`;\r\n        }\r\n        if(this.card.data.damage !== undefined){\r\n            html += `${this.card.data.damage}<br>`;\r\n        }\r\n        html += `${this.card.data.text.replace('\\n', '<br>')}`;\r\n        html += `</div>`;\r\n        return html;\r\n    }\r\n}\r\n\r\nclass SakuraTokenComponent extends Component {\r\n    cardId: string = null; \r\n    toHtml(): string{\r\n        return(`<div class=\"sakura-token\" draggable=\"true\" id=\"${this.htmlElementId}\"></div>`);\r\n    }\r\n\r\n    get zIndexOffset(): number {\r\n        return 100;\r\n    }\r\n}\r\n\r\nclass VigorComponent extends Component {\r\n    toHtml(): string{\r\n        return(`<div class=\"fbs-vigor-card\" id=\"${this.htmlElementId}\">\r\n        <div class=\"vigor0\"></div>\r\n        <div class=\"vigor1\"></div>\r\n        <div class=\"vigor2\"></div>\r\n        </div>`);\r\n    }\r\n\r\n    // 表示状態を決定\r\n    setVigor(value: number){\r\n        if(value === 0){\r\n            this.rotated = 1;\r\n        }\r\n        if(value === 1){\r\n            this.rotated = 0;\r\n        }\r\n        if(value === 2){\r\n            this.rotated = -1;\r\n        }\r\n                \r\n    }\r\n}\r\n\r\n// 盤を定義\r\nconst board = {\r\n    library: [new Card('01-yurina-o-n-1'), new Card('01-yurina-o-n-2'), new Card('01-yurina-o-n-3'), new Card('01-yurina-o-n-4')] as Card[],\r\n    hands: [new Card('01-yurina-o-n-7'), new Card('01-yurina-o-n-5'), new Card('01-yurina-o-n-6')] as Card[],\r\n    specials: [new Card('01-yurina-o-s-1'), new Card('01-yurina-o-s-2'), new Card('01-yurina-o-s-3')] as Card[],\r\n    used: [],\r\n    hiddenUsed: [],\r\n    vigor: 1,\r\n\r\n    tokensOnCard: {} as {[key: string]: number},\r\n\r\n    aura: 3,\r\n    life: 10,\r\n    flair: 0,\r\n    distance: 10,\r\n    dust: 0\r\n}\r\n\r\n// コンポーネント一覧\r\nconst components: Component[] = [];\r\n\r\n// 変数を定義\r\nlet draggingFrom: Component = null;\r\nlet contextMenuShowingAfterDrop: boolean = false;\r\n\r\n// 関数\r\nfunction shuffle(array) {\r\n    var n = array.length, t, i;\r\n\r\n    while (n) {\r\n        i = Math.floor(Math.random() * n--);\r\n        t = array[n];\r\n        array[n] = array[i];\r\n        array[i] = t;\r\n    }\r\n\r\n    return array;\r\n}\r\n\r\nfunction createCardComponent(card: Card, region: RegionName, indexOfRegion: number, opened: boolean = false){\r\n    let newCard = new CardComponent;\r\n    newCard.card = card;\r\n    newCard.htmlElementId = \"fbs-card-\" + card.id;\r\n    newCard.region = region;\r\n    newCard.indexOfRegion = indexOfRegion;\r\n    newCard.opened = opened;\r\n    components.push(newCard);\r\n\r\n    return newCard;\r\n}\r\n\r\nfunction createVigorComponent(){\r\n    let comp = new VigorComponent;\r\n    comp.region = 'vigor';\r\n    comp.htmlElementId = \"fbs-vigor-card\";\r\n    components.push(comp);\r\n}\r\n\r\nvar sakuraTokenTotalCount = 0;\r\nfunction createSakuraTokenComponent(region: SakuraTokenArea, count: number){\r\n    for(let i = 0; i < count; i++){\r\n        let newComp = new SakuraTokenComponent;\r\n        newComp.region = region;\r\n        newComp.indexOfRegion = i;\r\n        newComp.htmlElementId = `sakura-token-${sakuraTokenTotalCount}`;\r\n        sakuraTokenTotalCount++;\r\n        components.push(newComp);\r\n    }\r\n}\r\n\r\n// 盤上のコンポーネント表示を更新\r\nfunction updateComponents(){\r\n    // 山札の再配置\r\n    let libraryOffset = $('.area.library.background').position();\r\n    components.filter(x => x.region === 'library').forEach((comp, i) => {\r\n        comp.left = libraryOffset.left + 4 + comp.indexOfRegion * 8;\r\n        comp.top = libraryOffset.top + 4 + comp.indexOfRegion * 3;\r\n    });\r\n\r\n    // 手札の再配置\r\n    let handOffset = $('.area.hand.background').position();\r\n    components.filter(x => x.region === 'hand').forEach((comp, i) => {\r\n        comp.left = handOffset.left + 4 + comp.indexOfRegion * 108;\r\n        comp.top = handOffset.top + 4;\r\n    });\r\n\r\n    // 切り札の再配置\r\n    let specialOffset = $('.area.special.background').position();\r\n    components.filter(x => x.region === 'special').forEach((comp, i) => {\r\n        comp.left = specialOffset.left + 4 + comp.indexOfRegion * 108;\r\n        comp.top = specialOffset.top + 4;\r\n    });\r\n\r\n    // 使用済札の再配置\r\n    let usedOffset = $('.area.used.background').position();\r\n    components.filter(x => x.region === 'used').forEach((comp, i) => {\r\n        comp.left = usedOffset.left + 4 + comp.indexOfRegion * 108;\r\n        comp.top = usedOffset.top + 4;\r\n    });\r\n\r\n    // 伏せ札の再配置\r\n    let hiddenUsedOffset = $('.area.hidden-used.background').position();\r\n    components.filter(x => x.region === 'hidden-used').forEach((comp, i) => {\r\n        comp.left = 20 + hiddenUsedOffset.left + 4 + comp.indexOfRegion * 8;\r\n        comp.top = -20 + hiddenUsedOffset.top + 4 + comp.indexOfRegion * 3;\r\n    });\r\n\r\n    // 集中力の再配置\r\n    let vigorOffset = $('.area.vigor').position();\r\n    components.filter(x => x instanceof VigorComponent).forEach((comp, i) => {\r\n        if(comp.rotated === 0){\r\n            comp.left = vigorOffset.left;\r\n            comp.top = vigorOffset.top + 40;\r\n        } else {\r\n            comp.left = vigorOffset.left;\r\n            comp.top = vigorOffset.top + 20;\r\n        }\r\n    });\r\n\r\n    // 桜花結晶の再配置\r\n    let distanceOffset = $('.area.sakura-token-region.distance').position();\r\n    components.filter(x => x.region === 'distance').forEach((comp, i) => {\r\n        comp.left = distanceOffset.left + 60 + ((28 + 4) * i);\r\n        comp.top = distanceOffset.top + 2;\r\n    });\r\n\r\n    let dustOffset = $('.area.sakura-token-region.dust').position();\r\n    components.filter(x => x.region === 'dust').forEach((comp, i) => {\r\n        comp.left = dustOffset.left + 60 + ((28 + 4) * i);\r\n        comp.top = dustOffset.top + 2;\r\n    });\r\n\r\n    let auraOffset = $('.area.sakura-token-region.aura').position();\r\n    components.filter(x => x.region === 'aura').forEach((comp, i) => {\r\n        comp.left = auraOffset.left + 60 + ((28 + 4) * i);\r\n        comp.top = auraOffset.top + 2;\r\n    });\r\n\r\n    let lifeOffset = $('.area.sakura-token-region.life').position();\r\n    components.filter(x => x.region === 'life').forEach((comp, i) => {\r\n        comp.left = lifeOffset.left + 60 + ((28 + 4) * i);\r\n        comp.top = lifeOffset.top + 2;\r\n    });\r\n\r\n    let flairOffset = $('.area.sakura-token-region.flair').position();\r\n    components.filter(x => x.region === 'flair').forEach((comp, i) => {\r\n        comp.left = flairOffset.left + 60 + ((28 + 4) * i);\r\n        comp.top = flairOffset.top + 2;\r\n    });\r\n\r\n\r\n    components.filter(x => x.region === 'on-card').forEach((comp: SakuraTokenComponent, i) => {\r\n        let offset = $(`[data-card-id=${comp.cardId}]`).position();\r\n        \r\n        comp.left = offset.left + 2 + comp.indexOfRegion * 20;\r\n        comp.top = offset.top + 140 - 2 - 32;\r\n    });\r\n\r\n    // コンポーネントごとに描画/移動処理\r\n    let boardOffset = $('#BOARD').offset();\r\n    components.forEach((component, index) => {\r\n        let $elem: JQuery = null;\r\n        if(!component.drawn){\r\n            $('#BOARD').append(component.toHtml());\r\n            $elem = $(`#${component.htmlElementId}`);\r\n        }\r\n        \r\n        if(!component.drawn || component.isLocationChanged()){\r\n            if($elem === null){\r\n                $elem = $(`#${component.htmlElementId}`);\r\n            }\r\n\r\n            updateComponentAttributes(component, $elem);\r\n\r\n            // 古い位置情報を捨てる\r\n            component.updateLocation();\r\n        }\r\n\r\n        // 描画済フラグを立てる\r\n        if(!component.drawn){\r\n            component.drawn = true;\r\n        }\r\n    });\r\n\r\n    // ライブラリカウント増減\r\n    $('#LIBRARY-COUNT').text(board.library.length).css({right: parseInt($('.area.library.background').css('right')) + 8, bottom: parseInt($('.area.library.background').css('bottom')) + 8});\r\n}\r\n\r\nfunction updateComponentAttributes(component: Component, $elem: JQuery){\r\n    // ドラッグ可能の判定\r\n    if(component.draggable){\r\n        $elem.attr('draggable', '');\r\n    } else {\r\n        $elem.removeAttr('draggable');\r\n    }\r\n\r\n    // 回転\r\n    $elem.removeClass(['rotated', 'reverse-rotated']);\r\n    if(component.rotated === 1){\r\n        $elem.addClass('rotated');\r\n    } else if(component.rotated === -1){\r\n        $elem.addClass('reverse-rotated');\r\n    }\r\n\r\n    // カード用の処理\r\n    if(component instanceof CardComponent){\r\n        // 裏表の更新\r\n        $elem.removeClass(['open-normal', 'back-normal', 'open-special', 'back-special']);\r\n        if(component.card.data.baseType === 'normal'){\r\n            if(component.opened){\r\n                $elem.addClass('open-normal');\r\n            } else {\r\n                $elem.addClass('back-normal');\r\n            }\r\n        }\r\n        if(component.card.data.baseType === 'special'){\r\n            if(component.opened){\r\n                $elem.addClass('open-special');\r\n            } else {\r\n                $elem.addClass('back-special');\r\n            }\r\n        }\r\n\r\n        // 名称表示の更新\r\n        $elem.text(component.opened ? component.card.data.name : '');\r\n\r\n    }\r\n\r\n    // 集中力用の処理\r\n    if (component instanceof VigorComponent) {\r\n        if(board.vigor === 0){\r\n            $elem.find('.vigor1').addClass('clickable');\r\n            $elem.find(':not(.vigor1)').removeClass('clickable');\r\n        }\r\n        if(board.vigor === 1){\r\n            $elem.find('.vigor0, .vigor2').addClass('clickable');\r\n            $elem.find('.vigor1').removeClass('clickable');\r\n        }\r\n        if(board.vigor === 2){\r\n            $elem.find('.vigor1').addClass('clickable');\r\n            $elem.find(':not(.vigor1)').removeClass('clickable');\r\n        }\r\n    }\r\n    // 位置を移動 (向きを変えた後に実行する必要がある）\r\n    $elem.css({left: component.left, top: component.top});\r\n    $elem.css({zIndex: component.zIndexOffset + component.indexOfRegion});\r\n    \r\n    // リージョン属性付加\r\n    $elem.attr('data-region', component.region);\r\n}\r\n  \r\n\r\nfunction drawLibrary(){\r\n    board.library.forEach((card, i) => {\r\n        createCardComponent(card, 'library', i);\r\n    });\r\n}\r\n\r\nfunction drawHands(){\r\n    board.hands.forEach((card, i) => {\r\n        createCardComponent(card, 'hand', i, true);\r\n    });\r\n}\r\n\r\nfunction drawSpecials(){\r\n    board.specials.forEach((card, i) => {\r\n        createCardComponent(card, 'special', i);\r\n    });\r\n}\r\n\r\n\r\nfunction drawUsed(){\r\n    board.used.forEach((card, i) => {\r\n        createCardComponent(card, 'used', innerWidth, true);\r\n    });\r\n}\r\n\r\n\r\nfunction drawHiddenUsed(){\r\n    board.hiddenUsed.forEach((card, i) => {\r\n        createCardComponent(card, 'hidden-used', i);\r\n    });\r\n}\r\n\r\nfunction drawVigor(){\r\n    createVigorComponent();\r\n}\r\n\r\n\r\n\r\nfunction drawSakuraTokens(){\r\n    createSakuraTokenComponent('distance', 10);\r\n    createSakuraTokenComponent('aura', 3);\r\n    createSakuraTokenComponent('life', 10);\r\n}\r\n\r\nfunction appendLog(text: string){\r\n    $('#LOG-AREA').append(text).append('<br>');\r\n}\r\n\r\n\r\n// カードを移動\r\nfunction moveCard(from: CardArea, fromIndex: number, to: CardArea, addToBottom: boolean = false):boolean{\r\n    console.log('move card (%s[%d] -> %s)', from, fromIndex, to);\r\n\r\n    // 移動可能かどうかをチェック\r\n\r\n    // 移動\r\n    let card: Card;\r\n    if(from === 'library'){\r\n        card = board.library.splice(fromIndex, 1)[0];\r\n\r\n    }\r\n    if(from === 'hand'){\r\n        card = board.hands.splice(fromIndex, 1)[0];\r\n    }\r\n    if(from === 'used'){\r\n        card = board.used.splice(fromIndex, 1)[0];\r\n    }\r\n    if(from === 'hidden-used'){\r\n        card = board.hiddenUsed.splice(fromIndex, 1)[0];\r\n    }\r\n\r\n    let toTarget: Card[];\r\n    if(to === 'library'){\r\n        toTarget = board.library;\r\n    }\r\n    if(to === 'hand'){\r\n        toTarget = board.hands;\r\n    }\r\n    if(to === 'used'){\r\n        toTarget = board.used;\r\n    }\r\n    if(to === 'hidden-used'){\r\n        toTarget = board.hiddenUsed;\r\n    }\r\n    if(addToBottom){\r\n        toTarget.unshift(card);\r\n    } else {\r\n        toTarget.push(card);\r\n    }\r\n\r\n    // ログを追加\r\n    if(from === 'library' && to === 'hand'){\r\n        appendLog(`カードを1枚引く ⇒ ${card.data.name}`);\r\n    } else if(from === 'hand' && to === 'used'){\r\n        appendLog(`「${card.data.name}」を場に出す`);\r\n    } else if(from === 'hand' && to === 'hidden-used'){\r\n        appendLog(`「${card.data.name}」を伏せ札`);\r\n    } else {\r\n        let regionCaptions = {\r\n            'library': '山札',\r\n            'hand': '手札',\r\n            'used': '場',\r\n            'hidden-used': '伏せ札',\r\n            \r\n        };\r\n\r\n        appendLog(`${regionCaptions[from]}の「${card.data.name}」を${regionCaptions[to]}に移動`);\r\n    }  \r\n\r\n\r\n    // コンポーネントのインデックス更新\r\n    refreshCardComponentRegionInfo(from);\r\n    refreshCardComponentRegionInfo(to);\r\n\r\n    // 表示更新\r\n    updateComponents();\r\n\r\n    // 移動成功\r\n    return true;\r\n}\r\n\r\n\r\n// コンポーネントの領域情報を更新\r\nfunction refreshCardComponentRegionInfo(region: RegionName){\r\n    let cards: Card[];\r\n    if(region === 'library'){\r\n        cards = board.library;\r\n    }\r\n    if(region === 'hand'){\r\n        cards = board.hands;\r\n    }\r\n    if(region === 'used'){\r\n        cards = board.used;\r\n    }\r\n    if(region === 'hidden-used'){\r\n        cards = board.hiddenUsed;\r\n    }\r\n\r\n    // カード情報の更新\r\n    cards.forEach((card, i) => {\r\n        let comp = components.find(x => x instanceof CardComponent && x.card === card) as CardComponent;\r\n        comp.region = region;\r\n        comp.indexOfRegion = i;\r\n        comp.draggable = (comp.region !== 'library' || comp.indexOfRegion === board.library.length - 1);\r\n\r\n        // 領域に依存する情報更新\r\n        if(region === 'hand' || region === 'used'){\r\n            comp.opened = true;\r\n        }\r\n        if(region === 'library' || region === 'hidden-used'){\r\n            comp.opened = false;\r\n        }\r\n\r\n        if(region !== 'hidden-used'){\r\n            comp.rotated = 0;\r\n        }\r\n\r\n        if(region === 'hidden-used'){\r\n            comp.rotated = 1;\r\n        }\r\n    });\r\n}\r\n\r\n// コンポーネントの領域情報を更新\r\nfunction refreshSakuraTokenComponentInfo(){\r\n    let allSakuraTokens = components.filter(x => x instanceof SakuraTokenComponent);\r\n    let tokenIndex = 0;\r\n\r\n    // 対象領域にある結晶数に応じて表示更新\r\n    for(let i = 0; i < board.distance; i++){\r\n        let comp = allSakuraTokens[tokenIndex] as SakuraTokenComponent;\r\n        comp.region = 'distance';\r\n        comp.indexOfRegion = i;\r\n        tokenIndex++;\r\n    }\r\n\r\n    for(let i = 0; i < board.dust; i++){\r\n        let comp = allSakuraTokens[tokenIndex] as SakuraTokenComponent;\r\n        comp.region = 'dust';\r\n        comp.indexOfRegion = i;\r\n        tokenIndex++;\r\n    }\r\n\r\n    for(let i = 0; i < board.aura; i++){\r\n        let comp = allSakuraTokens[tokenIndex] as SakuraTokenComponent;\r\n        comp.region = 'aura';\r\n        comp.indexOfRegion = i;\r\n        tokenIndex++;\r\n    }\r\n\r\n    for(let i = 0; i < board.life; i++){\r\n        let comp = allSakuraTokens[tokenIndex] as SakuraTokenComponent;\r\n        comp.region = 'life';\r\n        comp.indexOfRegion = i;\r\n        tokenIndex++;\r\n    }\r\n\r\n    for(let i = 0; i < board.flair; i++){\r\n        let comp = allSakuraTokens[tokenIndex] as SakuraTokenComponent;\r\n        comp.region = 'flair';\r\n        comp.indexOfRegion = i;\r\n        tokenIndex++;\r\n    }\r\n\r\n    for(let cardId in board.tokensOnCard) {\r\n        if(board.tokensOnCard.hasOwnProperty(cardId)) {\r\n            console.log(\"key:\", cardId);\r\n            for(let i = 0; i < board.tokensOnCard[cardId]; i++){\r\n                let comp = allSakuraTokens[tokenIndex] as SakuraTokenComponent;\r\n                comp.region = 'on-card';\r\n                comp.cardId = cardId;\r\n                comp.indexOfRegion = i;\r\n                tokenIndex++;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// 桜花結晶を移動\r\nfunction moveSakuraToken(from: SakuraTokenArea, to: SakuraTokenArea, cardId: string, count: number = 1):boolean{\r\n    console.log('move sakura token (%s -> %s * %d)', from, to, count);\r\n\r\n    // 移動可能かどうかをチェック\r\n    if(from === 'distance'){\r\n        if(board.distance < count) return false; // 桜花結晶がなければ失敗\r\n    } else if(from === 'dust'){\r\n        if(board.dust < count) return false; // 桜花結晶がなければ失敗\r\n    } else if(from === 'aura'){\r\n        if(board.aura < count) return false; // 桜花結晶がなければ失敗\r\n    } else if(from === 'life'){\r\n        if(board.life < count) return false; // 桜花結晶がなければ失敗\r\n    } else if(from === 'flair'){\r\n        if(board.flair < count) return false; // 桜花結晶がなければ失敗\r\n    }\r\n    if(to === 'distance'){\r\n        if((board.distance + count) > 10) return false; // 間合い最大値を超える場合は失敗\r\n    } else if(to === 'aura'){\r\n        if((board.aura + count) > 5) return false; // オーラ最大値を超える場合は失敗\r\n    }\r\n\r\n    // 移動\r\n    if(from === 'distance'){\r\n        board.distance -= count;\r\n    } else if(from === 'dust'){\r\n        board.dust -= count;\r\n    } else if(from === 'aura'){\r\n        board.aura -= count;\r\n    } else if(from === 'life'){\r\n        board.life -= count;\r\n    } else if(from === 'flair'){\r\n        board.flair -= count;\r\n    }\r\n\r\n    if(to === 'distance'){\r\n        board.distance += count;\r\n    } else if(to === 'dust'){\r\n        board.dust += count;\r\n    } else if(to === 'aura'){\r\n        board.aura += count;\r\n    } else if(to === 'life'){\r\n        board.life += count;\r\n    } else if(to === 'flair'){\r\n        board.flair += count;\r\n    } else if(to === 'on-card'){\r\n        if(board.tokensOnCard[cardId] === undefined) board.tokensOnCard[cardId] = 0;\r\n        board.tokensOnCard[cardId] += count;\r\n    }\r\n    console.log(board);\r\n\r\n    // コンポーネントのインデックス更新\r\n    refreshSakuraTokenComponentInfo();\r\n\r\n    // 表示更新\r\n    updateComponents();\r\n\r\n    // 移動成功\r\n    return true;\r\n}\r\n\r\n\r\nfunction messageModal(desc: string){\r\n    $('#MESSAGE-MODAL .description').html(desc);\r\n    //$('#INPUT-MODAL').on('click', decideCallback);\r\n    $('#MESSAGE-MODAL')\r\n        .modal({closable: false})\r\n        .modal('show');\r\n}\r\nfunction userInputModal(desc: string, decideCallback: (this: JQuery, $element: JQuery) => false | void){\r\n    $('#INPUT-MODAL .description-body').html(desc);\r\n    //$('#INPUT-MODAL').on('click', decideCallback);\r\n    $('#INPUT-MODAL')\r\n        .modal({closable: false, onApprove:decideCallback})\r\n        .modal('show');\r\n}\r\n\r\n// /**\r\n//  * ゲームを開始可能かどうか判定\r\n//  */\r\n// function checkGameStartable(board: sakuraba.Board){\r\n//     // 両方のプレイヤー名が決定済みであれば、ゲーム開始許可\r\n//     if(board.data.p1Side.playerName !== null && board.data.p2Side.playerName !== null){\r\n//         $('#GAME-START-BUTTON').removeClass('disabled');\r\n//     }\r\n// }\r\n\r\nfunction setPopup(){\r\n    // ポップアップ初期化\r\n    $('[data-html],[data-content]').popup({\r\n        delay: {show: 500, hide: 0},\r\n        onShow: function(): false | void{\r\n            if(draggingFrom !== null) return false;\r\n        },\r\n    });\r\n}\r\n\r\n$(function(){\r\n\r\n    // socket.ioに接続\r\n    const socket = io();\r\n\r\n    socket.on('info', (message) => {\r\n        console.log('[SOCKET.IO INFO] ', message);\r\n    });\r\n    \r\n\r\n    // ボード情報をリクエスト\r\n    console.log('request_first_board_to_server');\r\n    socket.emit('request_first_board_to_server', {boardId: params.boardId, side: params.side});\r\n    //socket.emit('send_board_to_server', {boardId: params.boardId, side: params.side, board: board});\r\n\r\n    // ボード情報を受信した場合、メイン処理をスタート\r\n    socket.on('send_first_board_to_client', (receivingBoardData) => {\r\n        $('#P1-NAME').text(receivingBoardData.p1Side.playerName);\r\n        $('#P2-NAME').text(receivingBoardData.p2Side.playerName);\r\n\r\n        console.log('receive board: ', receivingBoardData);\r\n        let board = new sakuraba.Board(receivingBoardData);\r\n        let mySide = board.getMySide(params.side);\r\n        let opponentSide = board.getOpponentSide(params.side);\r\n\r\n        // まだ名前が決定していなければ、名前の決定処理\r\n        if(mySide.playerName === null){\r\n            let playerCommonName = (params.side === 'p1' ? 'プレイヤー1' : 'プレイヤー2');\r\n            let opponentPlayerCommonName = (params.side === 'p1' ? 'プレイヤー2' : 'プレイヤー1');\r\n            userInputModal(`<p>ふるよにボードシミュレーターへようこそ。<br>あなたは${playerCommonName}として卓に参加します。</p><p>プレイヤー名：</p>`, ($elem) => {\r\n                let playerName = $('#INPUT-MODAL input').val() as string;\r\n                if(playerName === ''){\r\n                    playerName = playerCommonName;\r\n                }\r\n                socket.emit('player_name_input', {boardId: params.boardId, side: params.side, name: playerName});\r\n                mySide.playerName = playerName;\r\n                $((params.side === 'p1' ? '#P1-NAME' : '#P2-NAME')).text(playerName);\r\n\r\n                messageModal(`<p>ゲームを始める準備ができたら、まずは「メガミ選択」ボタンをクリックしてください。</p>`);\r\n            });\r\n        }\r\n    });\r\n\r\n    // 他のプレイヤーがプレイヤー名を入力した\r\n    socket.on('on_player_name_input', (receivingBoardData: sakuraba.BoardData) => {\r\n        let board = new sakuraba.Board(receivingBoardData);\r\n        $('#P1-NAME').text(board.data.p1Side.playerName);\r\n        $('#P2-NAME').text(board.data.p2Side.playerName);\r\n    });\r\n\r\n    // メガミ選択ボタン\r\n    $('#MEGAMI-SELECT-BUTTON').click((e) => {\r\n        $('#MEGAMI-SELECT-MODAL').modal({closable: false, autofocus: false, onApprove:function(){\r\n            $('#DECK-BUILD-BUTTON').removeClass('disabled');\r\n        }}).modal('show');\r\n    });\r\n\r\n    // デッキ構築ボタン\r\n    $('#DECK-BUILD-BUTTON').click((e) => {\r\n        let cardIds: string[] = [];\r\n        for(let key in CARD_DATA){\r\n            if(key.match(/01-yurina/)){\r\n                cardIds.push(key);\r\n            }\r\n        }\r\n\r\n        cardIds.forEach((cardId, i) => {\r\n                \r\n            let card = new Card(cardId);\r\n            let comp = new CardComponent();\r\n            comp.card = card;\r\n            comp.htmlElementId = `deck-${card.id}`;\r\n            comp.opened = true;\r\n            comp.top = 4;\r\n            comp.left = 4 + i * (100 + 4);\r\n            \r\n            $('#DECK-BUILD-CARD-AREA').append(comp.toHtml());\r\n            \r\n            updateComponentAttributes(comp, $(`#${comp.htmlElementId}`));\r\n        });\r\n\r\n\r\n\r\n        let settings: SemanticUI.ModalSettings = {closable: false, autofocus: false, onShow: function(){\r\n            setPopup();\r\n        },\r\n        onApprove:function(){\r\n\r\n        }}\r\n        $('#DECK-BUILD-MODAL').modal(settings).modal('show');\r\n    });\r\n\r\n    // 盤を表示\r\n    drawUsed();\r\n    drawHiddenUsed();\r\n    drawLibrary();\r\n    drawHands();\r\n    drawSpecials();\r\n    drawVigor();\r\n    drawSakuraTokens();\r\n\r\n    refreshCardComponentRegionInfo('library');\r\n\r\n    // コンポーネントの表示を更新\r\n    updateComponents();\r\n\r\n    // ポップアップを設定\r\n    setPopup();\r\n\r\n    // ドロップダウン初期化\r\n    let values = [\r\n        {name: 'ユリナ (刀)', value: 'yurina'},\r\n        {name: 'ヒミカ (銃)', value: 'himika'},\r\n        {name: 'サイネ (薙刀)', value: 'saine'},\r\n        {name: 'シンラ (書)', value: 'shinra'},\r\n        {name: 'オボロ (忍)', value: 'oboro'},\r\n        {name: 'ユキヒ (傘)', value: 'yukihi'},\r\n        \r\n    ]\r\n    $('#MEGAMI1-SELECTION').dropdown({\r\n        placeholder: '1柱目を選択...',\r\n        values: values\r\n    });\r\n    $('#MEGAMI2-SELECTION').dropdown({\r\n        placeholder: '2柱目を選択...',\r\n        values: values\r\n    });\r\n\r\n    $('#MEGAMI1-SELECTION input[type=hidden], #MEGAMI2-SELECTION input[type=hidden]').on('change', function(e){\r\n        let megami1 = $('#MEGAMI1-SELECTION input[type=hidden]').val() as string;\r\n        let megami2 = $('#MEGAMI2-SELECTION input[type=hidden]').val() as string;\r\n\r\n        if(megami1 !== '' && megami2 !== ''){\r\n            $('#MEGAMI-SELECT-MODAL .positive.button').removeClass('disabled');\r\n        } else {\r\n            $('#MEGAMI-SELECT-MODAL .positive.button').addClass('disabled');\r\n        }\r\n    });\r\n\r\n    // ドラッグ開始\r\n    $('#BOARD').on('dragstart', '.fbs-card,.sakura-token', function(e){\r\n        this.style.opacity = '0.4';  // this / e.target is the source node.\r\n        //(e.originalEvent as DragEvent).dataTransfer.setDragImage($(this.closest('.draw-region'))[0], 0, 0);\r\n        let id = $(this).attr('id');\r\n        let comp = components.find(c => c.htmlElementId === id);\r\n\r\n        // 現在のエリアに応じて、選択可能なエリアを前面に移動し、選択したカードを記憶\r\n        if(comp.region === 'hand'){\r\n            // 手札\r\n            $('.area.droppable:not(.hand)').css('z-index', 9999);\r\n            draggingFrom = comp;\r\n        }\r\n\r\n        if(comp.region === 'library'){\r\n            // 山札\r\n            $('.area.droppable:not(.library)').css('z-index', 9999);\r\n            draggingFrom = comp;\r\n        }\r\n\r\n        if(comp.region === 'used'){\r\n            // 使用済札\r\n            $('.area.droppable:not(.used)').css('z-index', 9999);\r\n            draggingFrom = comp;\r\n        }\r\n\r\n        if(comp.region === 'hidden-used'){\r\n            // 伏せ札\r\n            $('.area.droppable:not(.hidden-used)').css('z-index', 9999);\r\n            draggingFrom = comp;\r\n        }\r\n\r\n        if(comp.region === 'distance'){\r\n            // 間合\r\n            $('.area.sakura-token-region.droppable:not(.distance)').css('z-index', 9999);\r\n            draggingFrom = comp;\r\n        }\r\n        if(comp.region === 'dust'){\r\n            // ダスト\r\n            $('.area.sakura-token-region.droppable:not(.dust)').css('z-index', 9999);\r\n            draggingFrom = comp;\r\n        }\r\n        if(comp.region === 'aura'){\r\n            // オーラ\r\n            $('.area.sakura-token-region.droppable:not(.aura)').css('z-index', 9999);\r\n            draggingFrom = comp;\r\n\r\n            // 場に出ている付与札があれば、それも移動対象\r\n            $('[data-region=used]').addClass('droppable');\r\n        }\r\n\r\n        if(comp.region === 'life'){\r\n            // ライフ\r\n            $('.area.sakura-token-region.droppable:not(.life)').css('z-index', 9999);\r\n            draggingFrom = comp;\r\n        }\r\n\r\n        if(comp.region === 'flair'){\r\n            // フレア\r\n            $('.area.sakura-token-region.droppable:not(.flair)').css('z-index', 9999);\r\n            draggingFrom = comp;\r\n        }\r\n\r\n        console.log('draggingFrom: ', draggingFrom);\r\n\r\n        $('.fbs-card').popup('hide all');\r\n\r\n    });\r\n\r\n    function processOnDragEnd(){\r\n        // コンテキストメニューを表示している場合、一部属性の解除を行わない\r\n        if(!contextMenuShowingAfterDrop){\r\n            $('[draggable]').css('opacity', '1.0');\r\n            $('.area,.fbs-card').removeClass('over');\r\n        }\r\n        \r\n        $('.area.droppable').css('z-index', -9999);\r\n        draggingFrom = null;\r\n    }\r\n\r\n    $('#BOARD').on('dragend', '.fbs-card,.sakura-token', function(e){\r\n        console.log('dragend', this);\r\n        processOnDragEnd();\r\n\r\n    });\r\n    $('#BOARD').on('dragover', '.droppable', function(e){\r\n        if (e.preventDefault) {\r\n            e.preventDefault(); // Necessary. Allows us to drop.\r\n        }\r\n        //e.dataTransfer.dropEffect = 'move';  // See the section on the DataTransfer object.\r\n\r\n        return false;\r\n    });\r\n\r\n    // ドラッグで要素に進入した\r\n    $('.area.droppable').on('dragenter', function(e){\r\n        console.log('dragenter', this);\r\n        $($(this).attr('data-background-selector')).addClass('over');\r\n    });\r\n\r\n    $('.area.droppable').on('dragleave', function(e){\r\n        console.log('dragleave', this);\r\n        $($(this).attr('data-background-selector')).removeClass('over');  // this / e.target is previous target element.\r\n    });\r\n    $('#BOARD').on('dragenter', '.fbs-card.droppable', function(e){\r\n        $($(this)).addClass('over');\r\n    });\r\n    $('#BOARD').on('dragleave', '.fbs-card.droppable', function(e){\r\n        $($(this)).removeClass('over');  // this / e.target is previous target element.\r\n    });\r\n\r\n\r\n    let lastDraggingFrom: Component; \r\n    $('#BOARD').on('drop', '.area,.fbs-card.droppable', function(e){\r\n        // this / e.target is current target element.\r\n        console.log('drop', this);\r\n        let $this = $(this);\r\n\r\n        if (e.stopPropagation) {\r\n            e.stopPropagation(); // stops the browser from redirecting.\r\n        }\r\n    \r\n        // ドロップ領域を特定\r\n        let to: RegionName;\r\n        if($this.is('.area.hand')) to = 'hand';\r\n        if($this.is('.area.used')) to = 'used';\r\n        if($this.is('.area.hidden-used')) to = 'hidden-used';\r\n        if($this.is('.area.library')) to = 'library';\r\n        if($this.is('.area.distance')) to = 'distance';\r\n        if($this.is('.area.dust')) to = 'dust';\r\n        if($this.is('.area.aura')) to = 'aura';\r\n        if($this.is('.area.life')) to = 'life';\r\n        if($this.is('.area.flair')) to = 'flair';\r\n        if($this.is('.fbs-card')) to = 'on-card';\r\n\r\n        if(draggingFrom !== null){\r\n            // 山札に移動した場合は特殊処理\r\n            if(to === 'library'){\r\n                lastDraggingFrom = draggingFrom;\r\n                contextMenuShowingAfterDrop = true;\r\n                $('#CONTEXT-DRAG-TO-LIBRARY').contextMenu({x: e.pageX, y: e.pageY});\r\n                return false;\r\n            } else {\r\n                // 山札以外への移動の場合\r\n                if(draggingFrom instanceof CardComponent){\r\n                    moveCard(draggingFrom.region as CardArea, draggingFrom.indexOfRegion, to as CardArea);\r\n                    return false;\r\n                }\r\n\r\n                if(draggingFrom instanceof SakuraTokenComponent){\r\n                    let cardId: string = null;\r\n                    if(to === 'on-card'){\r\n                        cardId = $(this).attr('data-card-id');\r\n                    }\r\n                    moveSakuraToken(draggingFrom.region as SakuraTokenArea, to as SakuraTokenArea, cardId);\r\n                    return false;\r\n                }\r\n            }\r\n\r\n\r\n\r\n        }\r\n\r\n        return false;\r\n    });\r\n\r\n    // 集中力のクリック\r\n    function vigorProcess(){\r\n        let vigComp = components.find(x => x instanceof VigorComponent) as VigorComponent;\r\n        vigComp.setVigor(board.vigor);\r\n        updateComponents();\r\n    }\r\n    $('#BOARD').on('click', '.fbs-vigor-card .vigor0.clickable', function(e){\r\n        e.preventDefault();\r\n        appendLog(`集中力－1　(→0)`)\r\n        board.vigor = 0;\r\n        vigorProcess();\r\n\r\n        return false;\r\n    });\r\n    $('#BOARD').on('click', '.fbs-vigor-card .vigor1.clickable', function(e){\r\n        e.preventDefault();\r\n        if(board.vigor === 2){\r\n            appendLog(`集中力－1　(→1)`);\r\n        } else {\r\n            appendLog(`集中力＋1　(→1)`);\r\n        }\r\n        board.vigor = 1;\r\n        vigorProcess();\r\n\r\n        return false;\r\n    });\r\n    $('#BOARD').on('click', '.fbs-vigor-card .vigor2.clickable', function(e){\r\n        e.preventDefault();\r\n        appendLog(`集中力＋1　(→2)`)\r\n        board.vigor = 2;\r\n        vigorProcess();\r\n\r\n        return false;\r\n    });\r\n\r\n    // ログ表示\r\n    $('#LOG-DISPLAY-BUTTTON').on('click', function(e){\r\n        $('#LOG-WINDOW').toggle();\r\n    });\r\n\r\n    // ターン終了\r\n    $('#TURN-END-BUTTON').on('click', function(){\r\n        $('.ui.modal').modal('show');\r\n    });\r\n\r\n    // 切札のダブルクリック\r\n    $('#BOARD').on('dblclick', '.fbs-card[data-region=special]', function(e){\r\n        e.preventDefault();\r\n        let cardIndex = $('.fbs-card[data-region=special]').index(this);\r\n        console.log('double click', cardIndex);\r\n\r\n        let card = board.specials[cardIndex];\r\n        let comp = components.find(x => x instanceof CardComponent && x.card === board.specials[cardIndex]) as CardComponent;\r\n\r\n        if(card.used){\r\n            card.used = false;\r\n            comp.opened = false;\r\n        } else {\r\n            card.used = true;\r\n            comp.opened = true;\r\n        }\r\n\r\n        updateComponents();\r\n        \r\n\r\n        return false;\r\n    });\r\n\r\n    // $('#BOARD').on('mouseenter', '.sakura-token', function(e){\r\n    //     let $region = $(this).closest('.draw-region');\r\n\r\n    //     // 自分のインデックスを取得\r\n    //     let index = $region.find('.sakura-token').index(this);\r\n\r\n    //     // 自分より後の要素を半透明にする\r\n    //     $region.find(`.sakura-token:gt(${index})`).css({opacity: 0.4});\r\n    // });\r\n    // $('#BOARD').on('mouseleave', '.sakura-token', function(e){\r\n    //     let $region = $(this).closest('.draw-region');\r\n    //     $region.find(`.sakura-token`).css({opacity: 1});\r\n    // });\r\n\r\n    // 山札ドラッグメニュー\r\n    $('#BOARD').append('<div id=\"CONTEXT-DRAG-TO-LIBRARY\"></div>');\r\n    $.contextMenu({\r\n        trigger: 'hidden',\r\n        selector: '#CONTEXT-DRAG-TO-LIBRARY',\r\n        callback: function(key: string) {\r\n            if(key === 'top'){\r\n                moveCard('hand', lastDraggingFrom.indexOfRegion, 'library');\r\n            }\r\n            if(key === 'bottom'){\r\n                moveCard('hand', lastDraggingFrom.indexOfRegion, 'library', true);\r\n            }\r\n        },\r\n        events: {\r\n            hide: function(options){\r\n                contextMenuShowingAfterDrop = false;\r\n                console.log(options);\r\n                processOnDragEnd();\r\n            }\r\n        },\r\n        items: {\r\n            'top': {name: '上に置く'},\r\n            'bottom': {name: '底に置く'},\r\n            'sep': '----',\r\n            'cancel': {name: 'キャンセル'}\r\n        }\r\n    });\r\n    // 山札右クリックメニュー\r\n    $.contextMenu({\r\n        selector: '#BOARD .fbs-card[data-region=library]',\r\n        callback: function(key: string) {\r\n            if(key === 'draw'){\r\n                moveCard('library', 0, 'hand');\r\n            }\r\n            if(key === 'reshuffle' || key === 'reshuffleWithoutDamage'){\r\n                // 山札、捨て札、伏せ札を全て加えてシャッフル\r\n                board.library = board.library.concat(board.hiddenUsed.splice(0)); \r\n                board.used.forEach(function(card, i){\r\n                    if(card.sakuraToken === undefined || card.sakuraToken === 0){\r\n                        board.library.push(card);\r\n                        board.used[i] = undefined;\r\n                    }\r\n                });\r\n                board.used = board.used.filter((c) => c !== undefined);\r\n                board.library = shuffle(board.library);\r\n\r\n                refreshCardComponentRegionInfo('library');\r\n                refreshCardComponentRegionInfo('used');\r\n                refreshCardComponentRegionInfo('hidden-used');\r\n\r\n\r\n                if(key === 'reshuffle') moveSakuraToken('life', 'dust', null);\r\n                updateComponents();\r\n                appendLog(`再構成`);\r\n            }\r\n        },\r\n        items: {\r\n            'draw': {name: '1枚引く', disabled: () => board.library.length === 0},\r\n            'sep1': '---------',\r\n            'reshuffle': {name: '再構成する', disabled: () => board.life === 0},\r\n            'reshuffleWithoutDamage': {name: '再構成する (ライフ減少なし)'},\r\n        }\r\n    });\r\n\r\n    // 集中力右クリックメニュー\r\n    $.contextMenu({\r\n        selector: '#BOARD .fbs-vigor-card',\r\n        callback: function(key: string) {\r\n        },\r\n        items: {\r\n            'wither': {name: '萎縮させる'},\r\n            'sep1': '---------',\r\n            'cancel': {name: 'キャンセル'},\r\n        }\r\n    });\r\n    // 桜花結晶右クリックメニュー\r\n    $.contextMenu({\r\n        selector: '#BOARD .sakura-token',\r\n        build: function($elem: JQuery, event: JQueryEventObject){\r\n            // 現在のトークン数を取得\r\n            let region = $elem.attr('data-region') as SakuraTokenArea;\r\n            let tokenCount = 0;\r\n            if(region === 'distance'){\r\n                tokenCount = board.distance;\r\n            }\r\n            if(region === 'dust'){\r\n                tokenCount = board.dust;\r\n            }\r\n            if(region === 'aura'){\r\n                tokenCount = board.aura;\r\n            }\r\n            if(region === 'life'){\r\n                tokenCount = board.life;\r\n            }\r\n            if(region === 'flair'){\r\n                tokenCount = board.flair;\r\n            }\r\n\r\n            let items = {};\r\n            let itemBaseData = [\r\n                {key: 'moveToDistance', name: '間合へ移動', region: 'distance'},\r\n                {key: 'moveToDust', name: 'ダストへ移動', region: 'dust'},\r\n                {key: 'moveToAura', name: 'オーラへ移動', region: 'aura'},\r\n                {key: 'moveToLife', name: 'ライフへ移動', region: 'life'},\r\n                {key: 'moveToFlair', name: 'フレアへ移動', region: 'flair'},\r\n            ];\r\n            itemBaseData.forEach((data) => {\r\n                if(region === data.region) return true;\r\n\r\n                items[data.key] = {name: data.name, items: {}};\r\n                for(let i = 1; i <= tokenCount; i++){\r\n                    items[data.key].items[i.toString()] = {name: `${i}つ`};\r\n                }\r\n                return true;\r\n            });\r\n            items['sep1'] =  '---------';\r\n            items['cancel'] =  {name: 'キャンセル'};\r\n\r\n            \r\n            return {\r\n                callback: function(key: string) {\r\n                },\r\n                items: items,\r\n            }\r\n            \r\n\r\n\r\n            // return {\r\n            //     callback: function(key: string) {\r\n            //     },\r\n            //     items: {\r\n            //         'move': {\r\n            //             name: '動かす',\r\n            //             items: {\r\n            //                 'dust': {\r\n            //                     name: 'ダストへ',\r\n            //                     items: {\r\n            //                         '1': {name: '1つ'},\r\n            //                         '2': {name: '2つ'},\r\n            //                         '3': {name: '3つ'},\r\n            //                     }\r\n            //                 }\r\n            //             }\r\n            //         },\r\n            //         'sep1': '---------',\r\n            //         'cancel': {name: 'キャンセル'},\r\n            //     }\r\n            // }\r\n    \r\n        },\r\n    });\r\n\r\n\r\n    // context.init({ above: 'auto' });\r\n    // context.attach('.area.library .fbs-card', [\r\n    //     { text: '1枚引く', action: (e) => moveLibraryToHands(0) }\r\n    //     , { divider: true }\r\n    //     , { text: '再構成する' }\r\n    //     , { text: '再構成する (ライフ減少なし)' }\r\n    // ]);\r\n\r\n    // context.attach('.area.hand .fbs-card', [\r\n    //     { text: '使用する' }\r\n    //     , { text: '伏せ札にする' }\r\n    //     , { divider: true }\r\n    //     , { text: '自分の山札の一番底に置く ' }\r\n    //     , { text: '相手の山札の一番上に置く (毒カード用)' }\r\n    // ]);\r\n\r\n    // context.attach('.area.distance .sakura-token', [\r\n    //     { text: '→ オーラ (前進)', action: (e) => {e.preventDefault(); moveSakuraToken('distance', 'aura'); return true;} }\r\n    //     , { divider: true }\r\n    //     , { text: '→ ダスト' }\r\n    //     , { text: '→ ライフ' }\r\n    //     , { text: '→ フレア' }\r\n    // ]);\r\n\r\n    // context.attach('.area.dust .sakura-token', [\r\n    //     { text: '→ オーラ (宿し)', action: (e) => {e.preventDefault(); moveSakuraToken('dust', 'aura'); return true;} }\r\n    //     , { text: '→ 間合 (離脱)', action: (e) => {e.preventDefault(); moveSakuraToken('life', 'aura'); return true;} }\r\n    //     , { divider: true }\r\n    //     , { text: '→ オーラ', action: (e) => {e.preventDefault(); moveSakuraToken('life', 'aura'); return true;} }\r\n    //     , { text: '→ ダスト' }\r\n    //     , { text: '→ 間合' }\r\n    // ]);\r\n\r\n    // context.attach('.area.aura .sakura-token', [\r\n    //     { text: '→ ダスト (ダメージ)'}\r\n    //     , { text: '→ フレア (宿し)', action: (e) => {e.preventDefault(); moveSakuraToken('aura', 'flair'); return true;}}\r\n    //     , { divider: true }\r\n    //     , { text: '→ ライフ', action: (e) => {e.preventDefault(); moveSakuraToken('aura', 'life'); return true;} }\r\n    //     , { text: '→ 間合' }\r\n    //     , { divider: true }\r\n    //     , { text: 'オーラの最大値を無限大に変更' }\r\n    // ]);\r\n\r\n    // context.attach('.area.life .sakura-token', [\r\n    //     { text: '→ フレア (ダメージ)', action: (e) => {e.preventDefault(); moveSakuraToken('life', 'flair'); return true;} }\r\n    //     , { divider: true }\r\n    //     , { text: '→ オーラ', action: (e) => {e.preventDefault(); moveSakuraToken('life', 'aura'); return true;} }\r\n    //     , { text: '→ ダスト' }\r\n    //     , { text: '→ 間合' }\r\n    // ]);\r\n\r\n    // context.attach('.area.flair .sakura-token', [\r\n    //     { text: '→ ダスト (消費)' }\r\n    //     , { divider: true }\r\n    //     , { text: '→ オーラ', action: (e) => {e.preventDefault(); moveSakuraToken('flair', 'aura'); return true;} }\r\n    //     , { text: '→ ライフ', action: (e) => {e.preventDefault(); moveSakuraToken('flair', 'life'); return true;} }\r\n    //     , { text: '→ 間合' }\r\n    // ]);\r\n\r\n  ;\r\n});","export type Side = 'p1' | 'p2' | 'watch';\r\n\r\nexport class Board {\r\n    data: BoardData;\r\n\r\n    constructor(data?: BoardData){\r\n        if(data !== undefined){\r\n            this.data = data;\r\n        } else {\r\n            this.data = new BoardData();\r\n        }\r\n    }\r\n\r\n    getMySide(side: Side){\r\n        if(side === 'p1'){\r\n            return this.data.p1Side;\r\n        } else if(side === 'p2'){\r\n            return this.data.p2Side;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    getOpponentSide(side: Side){\r\n        if(side === 'p1'){\r\n            return this.data.p2Side;\r\n        } else if(side === 'p2'){\r\n            return this.data.p1Side;\r\n        }\r\n        return null;\r\n    }\r\n}\r\n\r\nexport class BoardData {\r\n    dataVersion = 1;\r\n\r\n    distance: number = 10;\r\n    dust: number = 0;\r\n\r\n    actionLog: LogRecord[] = [];\r\n    chatLog: LogRecord[] = [];\r\n\r\n    p1Side: BoardSide;\r\n    p2Side: BoardSide;\r\n\r\n    constructor(){\r\n        this.p1Side = new BoardSide();\r\n        this.p2Side = new BoardSide();\r\n    }\r\n}\r\n\r\nexport class BoardSide {\r\n    playerName: string = null;\r\n\r\n    megamis: string[] = null;\r\n\r\n    aura: number = 3;\r\n    life: number = 10;\r\n    flair: number = 0;\r\n\r\n    vigor: number = 0;\r\n\r\n    library: Card[] = [];\r\n    hands: Card[] = [];\r\n    used: Card[] = [];\r\n    hiddenUsed: Card[] = [];\r\n}\r\n\r\nexport class LogRecord {\r\n    text: string;\r\n    created: Date;\r\n}\r\n\r\nexport class Card {\r\n    id: string;\r\n    sakuraToken?: number;\r\n}\r\n\r\nexport class SpecialCard extends Card {\r\n    used: boolean = false;\r\n}"],"sourceRoot":""}